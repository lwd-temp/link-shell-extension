<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html xmlns="https://www.w3.org/1999/xhtml">
<head>
    <meta content="HTML Tidy for Windows (vers 1st February 2003), see www.w3.org" name="generator" />
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
    <title>ln - command line hardlinks </title>

    <style type="text/css">
        body, td, th {
            font-family: Arial, 'Segoe UI', Verdana, Geneva, sans-serif;
            color: #000;
            background-color: #fff;
            vertical-align: top;
        }

        .bodytext {
            font-family: Arial, 'Segoe UI', Helvetica, sans-serif;
            vertical-align: top;
        }

        .hanger {
            font-weight: bold;
            color: #25049F;
            width: 130px;
            text-align: right;
            vertical-align: top;
        }

        .ascode {
            font-family: "Courier New", Courier;
            font-weight: bold;
            padding-left: 1.5em;
        }


        .outputtable {
            font-family: "Courier New", Courier;
            padding-left: 1em;
            font-size: .9em;
        }

        .hanger2 {
            font-size: .9em;
            font-weight: bold;
            text-align: left;
            vertical-align: top;
        }
    </style>


    <script type="text/javascript">
  /* <![CDATA[ */
      (function() {
          var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
          s.type = 'text/javascript';
          s.async = true;
          s.src = 'https://api.flattr.com/js/0.6/load.js?mode=auto';
          t.parentNode.insertBefore(s, t);
      })();
  /* ]]> */
    </script>
</head>
<body bgcolor="#FFFFFF">
    <table cellspacing="10" cellpadding="0" border="0">
        <tr>
            <td colspan="2">
                <img src="ln.png" alt="ln - command line hardlinks" />
            </td>
        </tr>
        <tr>
            <td colspan="2" height="22">
                <div align="right">
                    <i><font face="arial">Last Updated November 26, 2022 Version 2.9.3.4</font></i>
                </div>
            </td>
        </tr>

        <tr>
            <td class="hanger">
                <b>
                    <a name="datenschutzerklaerung">Privacy Statement</a>
                </b>
            </td>

            <td valign="bottom">
                The privacy statement can be found <a href="https://schinagl.priv.at/about/dsgvo.html">here</a>
            </td>
        </tr>

        <tr>
            <td width="130" class="hanger">
                <a name="quickstart"><b>Quick Start</b></a>
            </td>

            <td class="bodytext">
                <a href="#contact">Download</a><br />
                <a href="#introduction">Documentation</a><br />
                <a href="#faq">Frequently asked questions (FAQ)</a><br />
                <a href="#history">History</a><br />
                <a href="#contact">Donations</a><br /><br />
            </td>
        </tr>

        <!-- Introduction -->
        <tr>
            <td class="hanger">
                <a name="introduction">Introduction</a>
            </td>
            <td class="bodytext">
                The NTFS filesystem supports a lot of features like Hardlinks, Junctions
                Symbolic Links and Mount Points, which are sparsley supported by standard tools.
                This tool is kind of a NTFS Swiss Army Knife and can do lots of things, like create <a href="#smartcopy">SmartCopies</a>, which
                preserve the inner and outer Hardlink/Junction/SymbolicLink structure, does hardlink based incremental <a href="#deloreancopy">Backups</a>
                and a lot of other things which can not be found anywhere.<br />
                <br />
            </td>
        </tr>

        <!-- Installation -->
        <tr>
            <td class="hanger">
                Installation
            </td>
            <td class="bodytext">
                Copy ln.exe to some directory referenced by your PATH environment variable. %systemroot% is a good place.
                <br />
                <br />
                <br />
            </td>
        </tr>

        <!-- Chocolatey -->
        <tr>
            <td class="hanger">
                <a name="choco">Chocolatey<br />Installation</a>
            </td>

            <td class="bodytext">
                ln.exe can also be installed via <a href="https://chocolatey.org">chocolatey</a> by issuing
                <br /><br />
                <span class="ascode">
                    choco install ln
                </span>
                <br />
                <br />
                from a command prompt. Make sure you have <a href="https://chocolatey.org/install">chocolatey installed</a>.
                <br />
                <br />
                <br />
            </td>
        </tr>

        <!-- WinGet -->
        <tr>
            <td class="hanger">
                <a name="winget">Winget<br />Installation</a>
            </td>

            <td class="bodytext">
                The 64bit version of ln.exe can also be installed via <a href="https://winget.run/">winget</a> by issuing
                <br /><br />
                <span class="ascode">
                    winget install HermannSchinagl.ln
                </span>
                <br />
                <br />
                from a command prompt. Make sure you have <a href="https://winget.run/">winget installed</a>.
                <br />
                <br />
                <br />
            </td>
        </tr>

        <!-- How to read -->
        <tr>
            <td class="hanger">
                How to read
            </td>
            <td class="bodytext">
                ln.exe is able to perform many powerfull things and thus has lots of command line options.<br />
                The documentation on options in the section below are sorted in alphabetical order.
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>

        <!-- Using ln -->
        <tr>
            <td class="hanger">
                Using ln
            </td>
            <td class="bodytext">
                ln.exe is a typical command line utility like those found within the resource kit.
                Its' highlights are as follows:
            </td>
        </tr>

        <tr>
            <td align="right" valign="top">
                &nbsp;
            </td>
            <td valign="bottom">
                <table cellspacing="0" cellpadding="0" border="0">

                    <!-- Normal Linking -->
                    <tr>
                        <td class="hanger2">
                            <a name="normallinking"><b>Normal linking</b></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                Just for completeness: ln.exe can do the normal ln stuff too.
                            </p>
                            <br />
                            <span class="ascode">
                                ln sourcefile.txt destination.txt<br />
                            </span>
                            <p>
                                In the above example <i>sourcefile.txt</i> gets hard-linked to <i>destination.txt</i>
                            </p>
                            <br />
                            <span class="ascode">
                                ln sourcefile.txt dest_dir<br />
                            </span>
                            <p>
                                In the above example <i>sourcefile.txt</i> gets hard-linked to <i>dest_dir\sourcefile.txt</i>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- Absolute -->
                    <tr>
                        <td class="hanger2">
                            <a name="absolutesymboliclinks">
                                <b>--absolute</b><br />Absolute<br />
                                Symbolic Links
                            </a>
                        </td>
                        <td align="left" class="bodytext">
                            <a name="relativevsabsolutesymboliclinks"></a>The target of a symbolic link can either be
                            <ul>
                                <li>a fully qualified path starting at the root of a drive, e.g e:\data\cpp\myfile.txt</li>
                                <li>also fully qualified path but pointing to a volume, e.g. \\?\Volume{f6c8b244-1ce4-11e0-a607-005056c00008}\</li>
                                <li>or can be be specified relatively, e.g ..\..\data\cpp\myfile.txt</li>
                            </ul>
                            <p>
                                ln.exe by default tries to create <b>relative</b> target path names for symbolic
                                links as long as this is possible, e.g the file and its target are on the same logical
                                drive. Having relative symbolic link targets is much smarter especially when the
                                target of links is in the same directory. If a symbolic link and its target are
                                on different drives, ln.exe uses absolute pathnames.
                            </p>
                            <p>
                                If the creation of absolute target pathnames should be forced use the --absolute option.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --absolute --symbolic Sourcefile.txt Destination.txt
                            </span>
                            <p>
                                In the above example <i>Sourcefile.txt</i> gets linked to <i>Destination.txt</i>
                                with an absolute target path.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --absolute --symbolic Sourcefile.txt DestinationDirectory
                            </span>
                            <p>
                                In the above example a symbolic link <i>DestinationDirectory\Sourcefile.txt</i>
                                gets linked to <i>Sourcefile.txt </i> with an absolute target path.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --absolute --symbolic SourceDirectory DestinationDirectory
                            </span>
                            <p>
                                In the above example a symbolic link directory <i>SourceDirectory</i>
                                gets linked to <i>DestinationDirectory</i> with an absolute target path.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --absolute --symbolic SourceDirectory DestinationDirectory\
                            </span>
                            <p>
                                In the above example a symbolic link directory <i>DestinationDirectory\SourceDirectory</i>
                                gets linked to <i>SourceDirectory</i> with an absolute target path.
                                A traling backslash is the trigger for this to work.
                            </p>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>


                    <!-- anchor -->
                    <tr>
                        <td width="120" class="hanger2">
                            <a name="anchor"><b>--anchor</b><br />Supply Anchor Paths</a>
                        </td>
                        <td class="bodytext">
                            <p>
                                This option can be used together with other options like <a href="#smartcopy">--copy</a> and it supplies a
                                virtual path or an anchor to the  e.g copy process, so that junctions and absolute symbolic links can be
                                restored properly in the destination even if they would be <a href="#outerjunctionhandling">outer junctions/symbolic link</a>.
                            </p>
                            <br />
                            Think of the following task to be solved:<br />
                            <ul>
                                <li>For some unknown reason the system can't be booted from c:\ anymore</li>
                                <li>The system is booted from an external media, and your former drive c:\ is now available as e.g. e:\</li>
                                <li>The whole drive should be copied from e:\ to y:\ ( Because you put a fresh disc into y:\ )</li>
                                <li>Drive y:\ should afterwards replace your old c:\ and you would like to boot from it.</li>
                                <li>Most important: All junctions and symbolic links should be alive after this operation.</li>
                            </ul>
                            Your situation with respect to junctions and symbolic links is like this:
                            <br />
                            <br />
                            <img src="anchorpath.png" alt="Supply additional anchor path to a copy process" />
                            <br />
                            <br />
                            <p>
                                There are absolute junction/symbolic links in your structure, which point to c:\ but with respect to its
                                new root e:\ all junctions pointing to c:\ are now <a href="#innerjunction">outer junctions/symbolic link</a>.
                                A normal <a href="#smartcopy">--copy</a> would simply <a href="#crop">crop</a> these junctions, which is unwanted, because the
                                whole disk should be recovered as much as possible.
                            </p>

                            <br />
                            <br />
                            <p>
                                The solution is to broaden the scope for ln.exe to decide if it is an outer or inner junction by supplying
                                additional anchor path to the copy process.
                            </p>
                            <span class="ascode">
                                ln --anchor c:\ --destination c:\ --copy e:\ y:\
                            </span>
                            <p>
                                The above example supplies <i>c:\</i> as additional anchor path and lets ln.exe assume that all
                                junctions and symbolic links below e:\, which point to some places below <i>c:\</i> are inner junctions, and
                                thus are restored in the destination as junctions/symbolic links pointing to places below <i>c:\</i> properly.<br /><br>
                                The option --destination is needed because the inner junctions found on e: shall point to c: even if the destination of
                                this copy operation is y:\
                            </p>

                            But in real life situations are more complex : The original c:\ drive might also have junctions to e.g. d:\ e:\.
                            To also adress this do the following:
                            <ul>
                                <li>Mount your drive to be copied to some drive letter, where no junctions point to. In the above example f:\ would be fine</li>
                                <li>Use --anchor for each drive where you know junctions from former c:\ point to.</li>
                            </ul>
                            <br />
                            <span class="ascode">
                                ln --anchor c:\ --destination c:\ --anchor d:\ --destination d:\ --anchor e:\ --destination e:\ --copy f:\ y:\
                            </span>

                            <p>
                                The order of --anchor and --destination in the above example is important: They build kind of pairs.
                            </p>
                            <br />
                            <br />
                            <br />

                            <b>Copying a full drive</b>
                            <p>
                                The full black magic on copying with permissions a whole drive also includes the --backup switch
                            </p>
                            <span class="ascode">
                                ln --backup --anchor c:\ --copy e:\ y:\
                            </span>
                            <p>
                                Adding <a href="#backup">--backup</a> also copies all permissions, streams and the like.
                                Or you omit --backup and only use <a href="#keepsymlinkrelation">--keepsymlinkrelation.</a>
                            </p>
                            <br />
                            The --anchor options is also useful when working with <a href="#snapshotservice">snapshots</a>,
                            because snapshots can be mapped either as different drive or as UNC path. Both ways causing
                            the problem of junctions within snapshots to be recognized as outer junctions and thus beeing
                            cropped.
                            <br />
                            <br />
                            <br />
                            <b>Mirroring a drive</b>
                            <a name="anchormirror"></a>
                            <p>
                                If a system drive should be backuped regularly and data, which have been already copied in the
                                run before, should not be copied, then go for:
                            </p>
                            <br />
                            <span class="ascode">
                                ln --backup --anchor c:\ --mirror e:\ y:\
                            </span>
                            <p>
                                If this should be done via snapshots, see <a href="#vss_drivecopy.cmd">Copying a whole drive via snapshots</a>.
                                The above example does not use --destination. This means the inner junctions/symbolic links, which point to c: on the source now in the destination y: point to y:
                                <br />
                                <br />
                            </p>
                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <br />
                            <br />
                        </td>
                    </tr>

                    <!-- Backup -->
                    <tr>
                        <td class="hanger2">
                            <a name="backup"><b>--backup</b><br />Backup Mode<br /></a>
                        </td>
                        <td class="bodytext">
                            <p>
                                Using the <i>Backup Mode</i> ACLs aka <i>Access Control Lists</i>, which contain
                                the security for Files, Folders, Junctions or SymbolicLinks, and <i>Encrypted Files</i>
                                are also copied.
                            </p>

                            <a name="filetypescopied">ln.exe</a> thus copies
                            <ul>
                                <li>Alternative Streams on files and folders</li>
                                <li>EA Records on files and folders (rarely used)</li>
                                <li>Reparse Info</li>
                                <li>File Attributes</li>
                                <li>Timestamps: Creation Time, Last Access Time, Last Write Time</li>
                                <li>Sparse Files and Alternative Sparse Streams</li>
                                <li>Encrypted files</li>
                                <li>ACLs</li>
                            </ul>
                            <p>
                                The --backup switch is a modifier to all other operations like e.g --copy, --mirror or --delorean.
                            </p>

                            <span class="ascode">
                                ln --backup --copy x:\SourcePath x:\DestinationPath
                            </span>

                            <p>
                                All files with all the above mentioned attributes are copied from x:\SourcePath to x:\DestinationPath
                            </p>
                            <p>
                                The --backup mode automatically enables the <a href="#keepsymlinkrelation">--keepsymlinkrelation</a>
                                modifier.
                            </p>
                            <br />
                        </td>
                    </tr>

                    <!-- Copy -->
                    <tr>
                        <td class="hanger2">
                            <a name="smartcopy"><b>--copy</b><br />Smart Copy</a>
                        </td>
                        <td class="bodytext">
                            <p>
                                Smart Copy basically creates a copy of the directory structure from the source location to
                                the destination, but it preserves the inner hardlink structure and inner junction/symbolic
                                link relations of the source, and recreates this inner hardlink structure and inner junction/symbolic
                                link relation at the destination location:
                            </p>

                            <p>
                                With hardlinks it behaves as follows:
                            </p>
                            <img src="smartcopyhowto.png" alt="Smart Copy How To" />
                            <p>
                                <a name="saturatedhardlinks" />By closely looking at the above picture one can
                                find three different types of files:
                            </p>
                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="hanger2">
                                        <b>Normal Files</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The file B is a normal file. It gets copied as any other copy tool would do.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Saturated Hardlinks</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The files E and F are hardlinked together. In ln.exe terms they are called <i>Saturated Hardlinks</i>,
                                            because the reference count, which is here 2, matches the number of occurrences below 'Folder 1',
                                            which is here 2.
                                        </p>
                                        <p>
                                            In General: A hardlink is called <i>Saturated</i> with respect to a folder <i>F</i>,
                                            if the number of occurrences below the folder <i>F</i> matches the reference count.
                                        </p>
                                        <p>
                                            Saturated Hardlinks can be copied completely via Smart Copy.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Unsaturated Hardlinks</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        The Files A, C, D are hardlinked together. In ln.exe terms they are called <i>Unsaturated Hardlinks</i>,
                                        because the reference count, which is here 3, does not match the number of occurrences below 'Folder 1',
                                        which is here 2. Only C and D are below Folder 1.
                                        <p>
                                            In General: A hardlink is called <i>Unsaturated</i> with respect to a folder <i>F</i>,
                                            if the number of occurrences below the folder <i>F</i> is smaller than the reference
                                            count.
                                        </p>
                                        <p>
                                            Unsaturated Hardlinks can only be partially copied by Smart Copy. In the above example
                                            C and D are hardlinked together in the destination location, but the hardlink to
                                            A is broken. This means that the reference count of C and D is 2 in the destination
                                            location.
                                        </p>
                                        <br />
                                    </td>
                                </tr>
                            </table>

                            <p>
                                <a name="innerjunction" />With junctions or symbolic link directories <a href="#outerjunctionhandling">
                                    the default behaviour
                                </a> during smartcopy is as follows:
                            </p>
                            <img src="junctionshowto.png" alt="Behaviour for inner junctions" />
                            <p>
                                By closely looking at the above picture one can find three different types of folders/junctions:
                            </p>

                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="hanger2">
                                        <b>Normal Folders</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder 'Folder 3' is a normal folder. It gets copied with its content as any other copy tool would do.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Inner Junctions<br />Symlinks</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder 'Inner Junction/Symlink' is targeted at 'Inner Junction/Symlink Target'. In LSE
                                            terms this kind of folder is called <i> Inner Junction/Symlink</i>, because its target points to
                                            a folder, which is below the common anchor 'Folder 1'.
                                        </p>
                                        <p>
                                            <i>Inner Junctions/Symlinks</i> are restored properly via Smart Copy in the destination
                                            location.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Outer Junctions<br />Symlinks</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder 'Outer Junction/Symlink' is targeted at the folder 'Outer Junction/Symlink Target'. In ln.exe
                                            terms this kind of folder is called <i>Outer Junction/Symlink</i>, because its target points to
                                            a folder, which is in parallel and thus outside the anchor 'Folder 1'.
                                        </p>
                                        <p>
                                            <i>Outer Junctions/Symlinks</i> can be handled in three different ways. Please see
                                            the section on <a href="#outerjunctionhandling">Outer Junction/Symlink Handling.</a>
                                        </p>
                                        <br />
                                    </td>
                                </tr>
                            </table>

                            <p>
                                Symbolic Links to files behave as follows during Smart Copy:
                            </p>
                            <img src="symboliclinkhowto.png" alt="Behaviour for inner symbolic links" />
                            <p>
                                By closely looking at the above picture one can find three different types of files/symbolic
                                links:
                            </p>
                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="hanger2">
                                        <b>Normal Files</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The file A is a normal file. It gets copied as any other copy tool would do.
                                        </p>
                                        <br />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="hanger2">
                                        <b>Inner Symbolic<br />Links</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The symbolic link 'Inner Symlink' is targeted at 'Inner Symlink Target'. In LSE terms this kind
                                            of symbolic link is called <i>Inner Symlink</i>, because its target points to a file, which is below
                                            the common anchor 'Folder 1'.
                                        </p>
                                        <p>
                                            <i>Inner Symlinks</i> are restored properly via Smart Copy at the destination location.
                                        </p>
                                        <br />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="hanger2">
                                        <b>Outer Symbolic<br />Links</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The symlink 'Outer Symlink' is targeted at the folder 'Outer Symlink Target'. In LSE terms this
                                            kind of symbolic link is called <i>Outer Symlink</i>, because its target points to a file, which is in
                                            parallel and thus outside the anchor 'Folder 1'.
                                        </p>
                                        <p>
                                            <i>Outer Symlinks</i> are handled by Smart Copy depending on the <a href="#outerjunctionhandling">
                                                Outer Junction/Symbolic Link
                                            </a> handling.
                                        </p>
                                        <br />
                                    </td>
                                </tr>
                            </table>

                            <p>
                                e.g.:
                            </p>
                            <span class="ascode">
                                ln --copy x:\dir\dir2 y:\dir\newdir
                            </span>
                            <p>
                                In the above example the directories and files below <i>x:\dir\dir2</i> are copied to <i>y:\dir\newdir</i>, and
                                all hardlinks/junctions/symbolic links within <i>x:\dir\dir2</i> are copied/tied to their new locations
                                under <i>y:\dir\newdir</i>.
                            </p>
                            <p>
                                The --copy operation only copies if the files in the destination are either not
                                there, or if the files in the source are newer. Otherwise the item is skipped. See
                                also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <p>
                                <b>
                                    If you use ln.exe as a backup tool with the --copy option, please make sure you
                                    test that everything is copied. I tested ln --copy many times, and had no problems,
                                    but when it comes to backing up data, one has to be careful.
                                </b>
                            </p>
                            <p>
                                Smart Copy is a must if e.g. the whole content of a hard disk, which has lots of
                                hardlinks/junctions/symbolic links, should be copied to another hard disk. During
                                the Smart Copy operation empty folders get copied too and the time stamps of
                                folders/junctions/symbolic links are also restored at the corresponding destination
                                locations.
                            </p>
                            <p>
                                Because Smart Copy creates inner hardlinks/junctions/symbolic links, this feature
                                is only available on NTFS volumes.
                            </p>
                            <p>
                                Smart Copy also <a href="#filetypescopied">processes all</a> available alternative NTFS streams,
                                EA Records, Sparse Files of a file. To also copy the ACLs, see the <a href="#backup">Backup Mode</a>
                            </p>
                            <b>Output</b><br />
                            <p>
                                See <a href="#output">Output</a> among Delorean Copy for a detailed description
                                of Smart Copies output.
                            </p>
                            <br />
                            <b>Shell Integration</b>
                            <p>
                                The Copy or Smart Copy functionality is also available via
                                <a href="https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html#smartcopy">
                                    Link Shell Extension
                                </a>
                            </p>
                        </td>
                    </tr>

                    <!-- Crop -->
                    <tr>
                        <td class="hanger2">
                            <a name="outerjunctionhandling">
                                <b>--crop</b><br />Crop/Unroll/Splice<br />
                                Outer Junctions/<br />Symbolic Links
                            </a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                During <a href="#smartcopy">SmartCopy</a>, <a href="#smartmirror"> Smart Mirror</a>,
                                <a href="#deloreancopy">Delorean Copy</a> and <a href="#smartclone">Clone</a>
                                so called <a href="#innerjunction">Outer Junctions/Symlink directories</a> may need
                                processing. There are 3 different ways to deal with those Outer Junctions/Symlink
                                directories:
                            </p>

                            <table cellspacing="0" cellpadding="0" border="0">

                                <!-- Crop -->
                                <tr>
                                    <td class="hanger2">
                                        <b>Crop</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            <a name="crop"><i>Crop</i></a> breaks links to Outer Junctions/Symlink directories in the destination.
                                        </p>
                                        <p>
                                            <i>Crop</i> also applies to Outer Symlink Files.
                                        </p>
                                        <img src="outerjunctionscrop.png" alt="Cropping outer Junctions" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i>, but
                                            <i>Outer Junction/Symlink</i> is not available in the destination, because <i>
                                                Folder1/Outer
                                                Junction/Symlink
                                            </i> pointed to <i>Folder0/Outer Junction/Symlink Target</i>,
                                            which is not below <i>Folder1</i>.
                                        </p>
                                        <p>
                                            The objective behind cropping Outer Junctions/Symlink Directories is to get a pure
                                            copy during Smart Copy, Smart Mirror, Delorean Copy and Clone without connections
                                            to the source.<br />
                                            <br />
                                            Crop is the default behaviour of ln.exe, e.g.:
                                        </p>
                                        <span class="ascode">
                                            ln --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <br /><br />
                                        <br /><br />
                                    </td>
                                </tr>


                                <!-- Unroll -->
                                <tr>
                                    <td class="hanger2">
                                        <a name="unroll"><b>Unroll</b></a>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            <i>Unroll</i> follows Outer Junctions/Symlink Directories
                                            and rebuilds the content of Outer Junctions/Symlink Directories inside the hierarchy
                                            at the destination location.
                                        </p>
                                        <p>
                                            <i>Unroll</i> also applies to Outer Symlink Files, which means, that unroll causes
                                            the target of Outer Symlink Files to be copied to the destination location.
                                        </p>
                                        <br />
                                        <img src="outerjunctionsunroll.png" alt="Unroll Outer Junctions" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i>, and
                                            <i>Outer Junction/Symlink</i> and all the files/directories below <i>
                                                Outer Junction/Symlink
                                                Target
                                            </i> are copied to the folder <i>Outer Junction/Symlink</i> in the destination.
                                        </p>
                                        <p>
                                            The objective behind unrolling Outer Junctions/Symlink Directories is to get everything
                                            with which the source is connected and rebuild it as separate copy in the destination.
                                            It resembles the 'hair of the elephant' pattern: Pull on a hair of an elephant,
                                            and get the whole elephant.
                                        </p>
                                        <br />

                                        <p>
                                            The command line invocation below unrolls all junctions/symbolic link directories below "c:\Folder 1"
                                        </p>

                                        <span class="ascode">
                                            ln --unroll --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            In certain situations only certain junctions/symbolic link directories should be unrolled during
                                            SmartCopy, DeloreanCopy, SmartMirror or HardlinkClone. To accomplish this ln.exe can be run with
                                            wildcard expressions to specify certain directories for unrolling.
                                        </p>

                                        <span class="ascode">
                                            ln --unroll "MyJunc*" --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            To specify junctions/symbolic link directories for unrolling more fine grained regular expressions
                                            can be given:
                                        </p>

                                        <span class="ascode">
                                            ln --unrollregexp "[a-z]*" --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                                POSIX 1003.2 extended RE (ERE) syntax
                                            </a>. They are not casesensitiv. The regular expression specified under --unrollregexp is applied to the whole source path:
                                        </p>

                                        <span class="ascode">
                                            ln --unrollregexp "Folder 1\\MyJunc*" --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            In this example only Outer Junctions/Symbolic Link Directories, matching "Folder 1\\MyJunc*" are
                                            unrolled. Please make sure that the back slash \ is escaped by a double \\ as shown in the above example.
                                        </p>


                                        <br />
                                        <b>Advanced thoughts on Unrolling</b>
                                        <p>
                                            The picture above was just the simplest case, because <i>Unroll</i> does much more
                                            when it encounters complex situations. Think of an outer junctions/symbolic links,
                                            which itself contains junctions/symbolic links, which are inner with respect to
                                            the first outer junction symbolic link:
                                        </p>
                                        <img src="outerjunctionsunrollinner.png" alt="Unroll Inner Outer Junctions" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i>, and
                                            <i>Outer Junction/Symlink</i> and is unrolled as expected, but since <i>Junction/Symlink</i>
                                            is an inner junction with respect to <i>Outer Junction/Symlink Target</i>, the junction/symlink
                                            relation is restored in the destination.
                                        </p>
                                        <br /><br />

                                        <p>
                                            This kind of <b>nesting</b> can be much more complex:
                                        </p>
                                        <img src="outerjunctionsunrollinnernested.png" alt="Unroll Inner Outer Junctions" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i>, and
                                            <i>Outer Junction/Symlink</i> and is unrolled as expected, but then it starts to
                                            get fascinating, because we have two levels of outer junctions/symlinks which all
                                            have respective inner junctions/symlinks, and which are restored properly. Once
                                            you have followed through the above picture, you got it. It is not simple I know,
                                            but it is necessary to properly unroll.
                                        </p>
                                        <br /><br />

                                        <p>
                                            And complexity increases if <b>symbolic link files</b> are within unrolled outer
                                            junctions/symbolic links:
                                        </p>
                                        <img src="outerjunctionsunrollinnersymlink.png" alt="Unroll Inner Outer Junctions" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i>, and
                                            <i>Outer Junction/Symlink</i> and is unrolled as expected, but it contains <i>
                                                Inner
                                                Outer Symlink
                                            </i> which points to <i>Inner Outer Symlink Target</i> and this is
                                            an inner junction/symbolic link with respect to <i>Outer Junction/Symlink Target</i>
                                        </p>
                                        <p>
                                            But worth mentioning is the Symbolic Link <i>Outer Symlink</i>, which would be a
                                            definitive outer symbolic link, but since its targets parent-directory <i>
                                                Outer Junction/Symlink
                                                Target
                                            </i> is unrolled, <i>Outer Symlink</i> becomes an inner symbolic link with
                                            respect to <i>Folder1</i>.
                                        </p>
                                        <p>
                                            <i>File1 Symlink</i> is also an outer symbolic link, but its target parent-directory
                                            <i>Folder2</i> is not that lucky to get unrolled, so in the destination <i>File1 Symlink</i>
                                            is not a symbolic link any more, but a copy of the symbolic links' target.
                                        </p>
                                        <br /><br />

                                        <p>
                                            <b>Nested Reparse Points</b> are also an interesting use case, which the algorithm has to tackle with:
                                        </p>
                                        <img src="nestedreparsepoints.png" alt="Nested Reparse Points" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination</i>, and
                                            <i>Junction/Symlink F0</i> and is unrolled as expected, but it contains inner
                                            nested reparse points. <i>Nested</i> means Reparse point pointing to Reparse Points
                                        </p>
                                        <br /><br />

                                        <p>
                                            The Unroll functionality also opens up the possibility to have <b>circular</b> Junction/Symbolic
                                            Link relations among a set of copied items:
                                        </p>
                                        <img src="outerjunctionsunrollcircularity.png" alt="Unroll Junctions Circularities" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied via the --unroll option to <i>Destination/Folder1</i>.
                                            Smart Copy/Smart Mirror and Delorean Copy operations can deal with the above shown
                                            circularities and break circularities by not following the affected Junction/Symbolic
                                            Link.
                                        </p>
                                        <br /><br />
                                        <p>
                                            Junctions/Symbolic Links can also point to FAT drives or other NTFS drives requiring
                                            as a prerequisite unique Disk-IDs on all disks, which are chained together via Junctions/Symbolic
                                            links:
                                        </p>
                                        <img src="outerjunctionsunrolldiskid.png" alt="Unroll Junctions Unique DiskID" />
                                        <p>
                                            Hardlink siblings are found by matching the per NTFS volume unique file-id, but if
                                            more volumes are chained together it might happen that the same file-ids can be
                                            found on two different NTFS volumes. To address this all operations use the disk-id
                                            and the file-id to match hardlink siblings.
                                        </p>
                                        <p>
                                            Furthermore it is not allowed to have the disk-id 0xFFFF-FFFF, because the algorithms
                                            use this as internal indicator of a FAT drive.
                                        </p>
                                        <br /><br />

                                        <p>
                                            The Unroll option also allows to point multiple junctions to point to the same target location,
                                            which causes the algorithms to traverse the same items many times:
                                        </p>
                                        <img src="outerjunctionsunrollmultitraverse.png" alt="Unroll Junctions Multi-Traverse" />
                                        <p>
                                            At the first glance multiple traversing of items looks simple, but for files this
                                            means that multiple traversed files are the same in the destination and are hardlinked
                                            together. So don't be confused when you see hardlinks, which have never ever been
                                            there before.
                                        </p>
                                        <br />

                                        <p>
                                            <a name="mappednetworkdrive"></a>
                                            Copying Junction/Symbolic Links from mapped network drives also needs extra care, because
                                            junctions on the remote machine relate with path references only valid on the remote machine
                                            to each other:
                                        </p>
                                        <img src="mappednetworkdrive.png" alt="Mapped Network Drive Reparsepoint Resolution" />
                                        <br />
                                        The example in the above picture shows such a situation
                                        <ul>
                                            <li>
                                                X:\Src\Foo\Junction/Symlink is a junction on a Remote Machine, which points to X:\Src\Foo\Folder.
                                                It is a valid Junction.
                                            </li>
                                            <li>
                                                X:\Src\Foo is sharded via \\RemoteMachine\MyShare, which still is no problem.
                                            </li>
                                            <li>
                                                \\RemoteMachine\MyShare mapped to T:\ on a local machine is fine, but the Junction T:\Junction/Symlink,
                                                if asked for its target, will still return X:\Src\Foo\Folder even on the Local Machine. One could expect
                                                that the target is T:\Folder, but it is not for Junctions.
                                            </li>
                                            <li>
                                                When SmartCopy/Mirror/Delorean comes across such a situation, it translates the Junction correctly when
                                                it is copied onto the Local Machines drive Y:\, so that the final Junction target points correctly to
                                                Y:\Dest\Bar\Folder
                                            </li>
                                        </ul>

                                        <br />
                                        <br />
                                        <p>
                                            This option supports taking its arguments from file.
                                        </p>
                                        <span class="ascode">
                                            ln --unroll @List.txt --copy c:\source d:\b\dest
                                        </span>
                                        <p>
                                            The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                            <span class="ascode">
                                                <br />MountPoint
                                                <br />TheDirectory
                                                <br />Directory with blanks
                                            </span>
                                        </p>

                                        <br />
                                    </td>
                                </tr>

                                <!-- Splice -->
                                <tr>
                                    <td class="hanger2">
                                        <a name="splice"><b>Splice</b></a>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            <i>Splice</i> reconnects Outer Junctions/Symlink directories in the destination to their
                                            original targets.
                                        </p>
                                        <img src="outerjunctionssplice.png" alt="Splice outer Junctions" />
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i>, and
                                            <i>Outer Junction/Symlink</i> is available in the destination as junction, which
                                            points to the original location <i>Outer Junction/Symlink Target</i>.
                                        </p>
                                        <p>
                                            The objective behind splicing Outer Junctions/Symlink Directories to its original
                                            location is to get a copy during smartcopy, but to reuse Outer Junctions/Symlink
                                            Directories source locations.
                                        </p>

                                        <p>
                                            The command line invocation below splices all junctions/symbolic link directories below "c:\Folder 1"
                                        </p>

                                        <span class="ascode">
                                            ln --splice --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            In certain situations only certain junctions/symbolic link directories should be spliced
                                            during SmartCopy, DeloreanCopy, SmartMirror or HardlinkClone. To accomplish this ln.exe
                                            can be run with wildcard expressions to specify certain directories for splicing.
                                        </p>

                                        <span class="ascode">
                                            ln --splice "MyJunc*" --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            To specify junctions/symbolic link directories for splicing more fine grained regular expressions
                                            can be given:
                                        </p>

                                        <span class="ascode">
                                            ln --spliceregexp "[a-z]*" --copy "c:\Folder 1" "c:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                                POSIX 1003.2 extended RE (ERE) syntax
                                            </a>. They are not casesensitiv.
                                        </p>
                                        <br />
                                        <a name="mountpointcopy"></a>
                                        <p>
                                            The <i>Splice</i> functionality is also useful, when mountpoints should be copied. Mountpoints are very similar
                                            to Junctions, but point to a path always starting with <a href="#volumeguidsupport">\\?\VolumeGuid</a>.
                                        </p>
                                        <img src="mountpointssplice.png" alt="Copy Mountpoint with Splice " />
                                        <br />
                                        <br />
                                        <p>
                                            To specify a certain mountpoint to be copied specify it as argument to --splice:
                                        </p>
                                        <span class="ascode">
                                            ln --splice "Mountpoint" --copy "x:\Folder 1" "x:\Destination\Folder 1"
                                        </span>
                                        <p>
                                            In the above example <i>Folder1</i> is copied to <i>Destination/Folder1</i> and the
                                            <i>Mountpoint</i> is created in the destination as <i>Mountpoint</i> again. It
                                            points to the original location under <i>\\?\Volume{b4..bc}</i>.
                                        </p>

                                        <p>
                                            Or drive complexity up one level and just use splice for mountpoints with wildcards, but unroll the rest.
                                        </p>
                                        <span class="ascode">
                                            ln --unroll --splice "Mountpo*" --copy "x:\Folder 1" "x:\Destination\Folder 1"
                                        </span>

                                        <br />
                                        <br />
                                        <p>
                                            This option supports taking its arguments from file.
                                        </p>
                                        <span class="ascode">
                                            ln --splice @List.txt --copy c:\source d:\b\dest
                                        </span>
                                        <p>
                                            The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                            <span class="ascode">
                                                <br />MountPoint
                                                <br />TheDirectory
                                                <br />Directory with blanks
                                            </span>
                                        </p>
                                        <br />
                                        <br />
                                        <br />
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- deloreandelete -->
                    <tr>
                        <!-- Deleting files -->
                        <td class="hanger2">
                            <a name="deloreandelete" /> <b>--delete</b><br />DeLorean Delete</a>
                        </td>
                        <td class="bodytext">
                            In general deleting files seems so simple, but when taking a closer look at the delorean copy use case, things get interesting:
                            <br />
                            <br />
                            Creating and keeping many Delorean Copies in a Delorean Set is something which is fairly simple, and even when it comes
                            to deleting a specific Delorean Copy from a Delorean Set it is easy. Simply press delete in Explorer, or use the --delete
                            option from ln.exe:
                            <br />
                            <br />
                            <img src="blog/deloreandelete.png" alt="Deleting Delorean Copies" />
                            <br />
                            <br />
                            <br />

                            <span class="ascode">
                                ln --delete x:\Bkp2
                            </span>
                            <p>
                                In the above example the directories and files below <i>x:\Bkp2</i> are deleted.
                            </p>

                            <br />
                            <br />
                            But wait! It is that easy if a Delorean Copy contains no files with ReadOnly attributes. Otherwise it's getting sophisticated:
                            <br />

                            <br />
                            <img src="blog/deloreandelete_sequence.png" alt="Deleting Delorean Copies - Use Case" />
                            <br />
                            <br />
                            <ol>
                                <li>
                                    A <i>Source</i> was used to create three successive Delorean Copies: <i>Bkp1</i>,<i>Bkp2</i>,<i>Bkp3</i>. File B is ReadOnly in the Source and
                                    in all Delorean Copies. So far so good.
                                </li>
                                <li>
                                    When it comes to delete <i>Bkp2</i> the Readonly attribute of <i>Bkp2/B</i> has to be removed, otherwise deletion is impossible.
                                </li>
                                <li>
                                    Due to the fact that all siblings of a hardlink share the same attribute and the same date, the readonly attributes of <i>Bkp1/B</i> and <i>Bkp3/B</i> are also
                                    'changed'. This is shown via the blue dotted lines. Called it 'Hardlink Attribute Teleportation'
                                </li>
                                <li>
                                    This results now in having a different attribute in <i>Bkp1/B</i> and <i>Bkp3/B</i> than in <i>Source/B</i>. This is shown via the grey dotted line.
                                </li>
                                <li>
                                    A fourth delorean copy with <i>Source</i> and <i>Bkp3</i> as Backup to <i>Bkp4</i> is created.
                                </li>
                                <li>
                                    Since the attributes of <i>Bkp3/B</i> and <i>Source/B</i> are different, the file <i>Bkp4/B</i> was copied over freshly from <i>Source/B</i>. So there is no
                                    hardlink between <i>Bkp3/B</i> and <i>Bkp4/B</i>, which is shown with the light red dotted line, and which is the basic problem.
                                </li>
                            </ol>
                            So how to overcome this:
                            <ol>
                                <li>
                                    Before deleting <i>Bkp2/B</i> retrieve at least one hardlink sibling, e.g. <i>Bkp1/B</i>
                                </li>
                                <li>
                                    Delete <i>Bkp2/B</i>
                                </li>
                                <li>
                                    Restore the attribute of <i>Bkp2/B</i> to one hardlink sibling, which has been retrieved in 1. e.g. <i>Bkp1/B</i> and rely on Hardlink Attribute Teleportation, so
                                    that it spreads to all other siblings.
                                </li>
                            </ol>
                            Basically this is what the --delete option does.
                            <br />
                            <br />
                            <br />
                            <br />
                        </td>
                    </tr>

                    <!-- DeLorean -->
                    <tr>
                        <td class="hanger2">
                            <a name="deloreancopy"><b>--delorean</b><br />DeLorean Copy</a>
                        </td>
                        <td class="bodytext">
                            <p>
                                DeLorean Copy is a way of creating incremental backups by using a combination of Hardlink Clone
                                and <a href="#smartmirror">SmartMirror</a>.
                            </p>
                            <p>
                                The following picture gives an overview of what DeLorean Copy is about
                            </p>
                            <img src="zeiteisen.png" alt="DeLorean Copy Behaviour" />
                            <p>
                                In general a DeLorean Copy has 3 principals: Source(t), InitialBackup and Backup(n), where <i>t</i> represents time
                                and <i>n</i> the number of backups.
                            </p>

                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="hanger2">
                                        <b>Phase 1: Initial SmartCopy</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder <i>Source(t)</i> is initially copied to <i>InitialBackup</i>. This is shown by the blue arrow.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Changes<br />happen</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            During this phase the files under source change, and <i>Source(t)</i> becomes <i>Source(t+1).</i>
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Phase 2: Hardlink Clone<br /></b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder <i>InitialBackup</i> is Hardlink Cloned to <i>Backup1,</i> which ties <i>InitialBackup</i>
                                            and <i>Backup1</i>. This is shown by the red arrow.<br />
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Phase 3: Mirror<br /></b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        Mirror the folder <i>Source</i> to <i>Backup1</i>. This is shown by the green arrow:
                                        <ul>
                                            <li>Keep unchanged files as hardllinks to InitialBackup.</li>
                                            <li>Delete files no longer in Source(t+1) from Backup1.</li>
                                            <li>Copy different files from <i>Source(t+1)</i> to <i>Backup1.</i></li>
                                        </ul>
                                    </td>
                                </tr>

                            </table>

                            <p>
                                With completion of this first round <i>Backup1</i> contains the first lean and mean
                                copy of <i>Source</i> only consisting of either hardlinks to <i>InitialBackup</i>,
                                or of copied files if there was the need to copy them over from <i>Source(t+1)</i>
                                because they were newer under <i>Source(t+1)</i>.
                            </p>

                            <p>
                                The point is that all files in <i>Backup1</i> are transparently accessible, but
                                little space is used, because not all files in the <i>Source(t+1)</i> changed,
                                so that there was only the need to effectively copy over a few files from <i>Source(t+1)</i>
                                to <i>Backup1</i>.
                            </p>

                            <p>
                                The time stamps for LastWriteTime, CreationTime and LastAccessTime of files/folders/junctions/symbolic links
                                are also restored at the corresponding destination locations during DeloreanCopy.
                            </p>


                            <p>
                                <i>Different</i> items means: Either the file size has changed, or the <i>LastWriteTime</i> has changed.
                            </p>
                            <br />

                            <p>
                                This can be repeated on and on. The second round would be using <i>Source</i>, <i>Backup1</i>
                                and <i>Backup2</i> for DeLorean Copy:
                            </p>

                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="hanger2">
                                        <b>Changes<br />happen</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            During this phase the files under source change, and <i>Source(t+1)</i> becomes <i>Source(t+2).</i>
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Phase 2: Hardlink Clone<br /></b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder <i>Backup1</i> is Hardlink Cloned to <i>Backup2,</i>
                                            which ties <i>Backup1</i> and <i>Backup2</i>. This is shown by the red arrow.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Phase 3: Mirror<br /></b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        Mirror the folder <i>Source(t+2)</i> to <i>Backup2</i>. This is shown by the green arrow:
                                        <ul>
                                            <li>Keep unchanged files as hardllinks to Backup1.</li>
                                            <li>Delete files no longer in Source(t+2) from Backup2.</li>
                                            <li>Copy different files from <i>Source(t+2)</i> to <i>Backup2.</i></li>
                                        </ul>
                                        <br />
                                    </td>
                                </tr>

                            </table>
                            <p>
                                <b>A real word example looks like this</b>:
                            </p>

                            <span class="ascode">
                                ln --copy x:\dir\Source x:\dir\InitialBackup
                            </span>
                            <p>
                                This creates the initial Backup as shown above in <i>Phase 1</i>
                            </p>
                            <br />

                            <span class="ascode">
                                ln --delorean x:\dir\Source x:\dir\InitialBackup x:\dir\Backup1
                            </span>
                            <p>
                                This command does the first round of DeLorean copy as shown above
                                in <i>Phase 2 and Phase 3</i> creating a backup.
                            </p>

                            <span class="ascode">
                                ln --delorean x:\dir\Source x:\dir\Backup1 x:\dir\Backup2
                            </span>
                            <p>
                                This command creates another set of incremental DeLorean copy as shown above in <i>
                                    Phase 2
                                    and Phase 3
                                </i> creating another backup.
                            </p>
                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>

                            <b><a name="logging">Logging</a></b><br />
                            <p>
                                The logging generated by DeLorean Copy/Smart Copy/Smart Clone/Smart Mirror looks like e.g.:
                            </p>
                            <span class="ascode">
                                <br />-f c:\backup\test\deleteme.dat
                                <br />=d c:\backup\test\directorygone
                                <br />+f c:\data\test\1.dat
                                <br />+f c:\data\foo\3.dat
                                <br />*h c:\data\foo\Hardlink of 3.dat
                                <br />*h c:\data\foo\Another Hardlink of 3.dat
                                <br />.h c:\data\already\x.dat
                                <br />*h c:\data\already\Hardlink of x.dat
                                <br />~f c:\data\failed\DidntMatch--splice.txt
                                <br />!?f (0x00000002) c:\data\failed\AccessDenied.txt
                            </span>
                            <br /><br />
                            <p>
                                Delorean Copy logs each action it did, and prefixes two characters
                                to each item which it processed for each line of output. The first column of the output
                                contains the <i>Operation</i> which was performed, and the second column specifies the
                                <i>Type</i> of item which was processed.<br />
                            </p>

                            <table cellspacing="0" cellpadding="0">
                                <tr>
                                    <td class="bodytext">
                                        <b>Operation</b>
                                    </td>
                                    <td class="bodytext">
                                        <b>Description</b>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        =
                                    </td>
                                    <td class="bodytext">
                                        Item is already present in the target. Used during Smart Mirror
                                    </td>
                                </tr>

                                <!-- One day we could give a message when just the compression status changes. The engine could do this
                            <tr>
                                <td class="bodytext">
                                    %
                                </td>
                                <td class="bodytext">
                                    Item is already present in the target, but with different compression state. Used during Smart Mirror
                                </td>
                            </tr>
                            -->

                                <tr>
                                    <td class="bodytext">
                                        +
                                    </td>
                                    <td class="bodytext">
                                        Copy/Create an item. Used during Smart Copy
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        *
                                    </td>
                                    <td class="bodytext">
                                        Hardlink a file
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        .
                                    </td>
                                    <td class="bodytext">
                                        Item is already present in the target and is used as the source of a newly created hardlink.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        -
                                    </td>
                                    <td class="bodytext">
                                        Remove an item from the target that is not present in the source. Used during Smart Mirror
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        ?
                                    </td>
                                    <td class="bodytext">
                                        Enumerate an item.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        ~
                                    </td>
                                    <td class="bodytext">
                                        Item has been excluded by command line arguments.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        #
                                    </td>
                                    <td class="bodytext">
                                        Item has been cropped due to being an outer junction/symlink.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        &
                                    </td>
                                    <td class="bodytext">
                                        Junction or Symbolic Link has been re-created but turned out to be dangling in the destination.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        \
                                    </td>
                                    <td class="bodytext">
                                        Opening a file.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        /
                                    </td>
                                    <td class="bodytext">
                                        Map file into address space.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <a name="markermerge">&deg</a>
                                    </td>
                                    <td class="bodytext">
                                        Hardlinks have been <a href="#merge">merged</a>.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <a name="markermergeexceeded">&deg~</a>
                                    </td>
                                    <td class="bodytext">
                                        Hardlinks were not <a href="#merge">merged</a>, because the hardlink reference count of 1023 was exceeded.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <a name="markermergeexists">&deg=</a>
                                    </td>
                                    <td class="bodytext">
                                        Hardlinks were not <a href="#merge">merged</a>, because the were already hardlinked.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        !
                                    </td>
                                    <td class="bodytext">
                                        An error happened. The value in brackets is the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx">system error code</a>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        '
                                    </td>
                                    <td class="bodytext">
                                        Informal message.
                                    </td>
                                </tr>

                            </table>

                            <br /><br />


                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="bodytext">
                                        <b>Item</b>
                                    </td>
                                    <td class="bodytext">
                                        <b>Description</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bodytext">
                                        f
                                    </td>
                                    <td class="bodytext">
                                        A File is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        h
                                    </td>
                                    <td class="bodytext">
                                        A Hardlink is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        s
                                    </td>
                                    <td class="bodytext">
                                        A Symbolic link file or Symbolic Link Directory.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        j
                                    </td>
                                    <td class="bodytext">
                                        A Junction is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        m
                                    </td>
                                    <td class="bodytext">
                                        A Mountpoint is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        d
                                    </td>
                                    <td class="bodytext">
                                        A Directory is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        t
                                    </td>
                                    <td class="bodytext">
                                        An Alternative Stream is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        e
                                    </td>
                                    <td class="bodytext">
                                        An E/A Record is processed.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        p
                                    </td>
                                    <td class="bodytext">
                                        A Sparse file is processed.
                                    </td>
                                </tr>

                            </table>
                            <br /><br />

                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="bodytext">
                                        <b>Sample</b>
                                    </td>
                                    <td class="bodytext">
                                        <b>Description</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">+f c:\data\myfile.txt</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            A normal file is copied.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">*h c:\data\hardlnk.txt</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            c:\data\hardlnk.txt is hardlinked to c:\data\myfile.txt.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">+s d:\dest\symlink.txt</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            A Symbolic link has been created.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">+j d:\dest\junc01</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            A Junction has been created.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">+d d:\dest\mydir</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            A Directory has been created.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">-f d:\dest\delfile</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The file d:\dest\delfile has been removed during e.g. Smart Mirror.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">-j d:\dest\junc02</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The Junction d:\dest\junc02 has been removed.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">+m d:\dest\mountpoint</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The mountpoint d:\dest\mountpoint has been created during e.g. Smart Copy.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">=d d:\dest\mydir</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The directory d:\dest\mydir is the same as in the source.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">=s d:\dest\symlink</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The symlink d:\dest\symlink is the same as in the source.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">.h d:\dest\file.txt</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            means that the name of this file is only printed,
                                            because some hardlinks have been newly tied to it. The file itself is already
                                            in the backup available, but the files following it are prefixed with * and are the
                                            newly tied hardlinks.<br />
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">*h d:\dest\new_hlink</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            If the line above is prefixed with . it means that
                                            d:\dest\new_hlink is tied to e.g. the already existing file d:\dest\file.txt.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">~d d:\source\mydir</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The directory d:\source\mydir has been excluded intentionally by e.g. --exclude.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">~f d:\source\aFile</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The file d:\source\aFile has been excluded intentionally by
                                            e.g. --exclude. Items are also listed with ~ if the --unroll option is not used and outer
                                            Junctions or Symbolic Links are cropped.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">#d d:\source\outerreparse</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The junction/symlink d:\source\outerreparse has been excluded
                                            because it was an <a href="#innerjunction">outer junction/symlink</a>.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">

                                        <span class="ascode"><a name="danglingjunction">&d d:\dir\danglingreparse</a></span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The Junction or Symbolic Link d:\dir\danglingreparse has been restored,
                                            but it turned out that it is dangling in the destination.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">!-d (0x00000002) d:\source\aFile</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The ! operator indicates that there was an error.
                                            It is followed by the operation, the item which was processed and an Win32 error code.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">!?d (0x00000005) d:\src\deny</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The ? operator means the current operation was unable to enumerate all available files.
                                            It is always prefixed with ! to signal that during enumeration of items something went wrong.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><a name="error03e7">!+f (0x000003e7) d:\v\v.tc</a></span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The ERROR_SWAPERROR means, that errors occurred during reading of a file. e.g.
                                            caused by unplugging the network cable.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><a name="error0585">!*h (0x00000585) d:\</a></span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The error INVALID_INDEX aka 0x0585 means that the NTFS implementation of this drive is broken. It returns
                                            the same file-index for files with different file size.<br />
                                            This is only a warning and ln.exe continues but ignores the retrieved file-indices.
                                            <br />
                                            See also <a href="#dupemerge">--dupemerge</a>
                                            <br />
                                            <br />
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><a name="eafailed">!+e (0x000000005) d:\test\A</a></span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The error ERROR_ACCESS_DENIED with !+e means EA Records could not be copied.
                                            This happens if a filesystem does not support EA Records, as it is with some NAS implementations.
                                            <br />
                                            <br />
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><a name="adsfailed">!+t (0x00000007b) d:\test\A:ADS1</a></span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The error ERROR_INVALID_NAME aka 0x007b with !+t means an Alternative Data Stream of a file could not be copied.
                                            This happens if a filesystem does not support Alternative Data Streams, as it is with some NAS implementations.
                                            <br />
                                            <br />
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><a name="symlink_fail_01">!+s (0x00000013d) t:\f3\f3_j0</a></span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            The error ERROR_MR_MID_NOT_FOUND aka 0x007b with !+s means that the driver for symbolic links under Windows XP
                                            was not able to resolve a symbolic link on a mapped network drive.
                                            <br />
                                            This is a technical limiation, which can't be overcome as the author of the driver Masatoshi Kimura explained, because to resolve
                                            a symbolic link via network one has to send the symbolic link target to the server, which hosts the network connection.
                                            Since SMBv1, which is available on WindowsXP is not able to transport this string, it is impossible to resolve a
                                            symbolic link on network drives.
                                            <br />

                                            a problem. It stops in resolving with the error code STATUS_STOPPED_ON_SYMLINK.
                                            I stumbled accross that message when ln.exe tried to follow symbolic links on mapped network drives. Since the
                                            symbolic link driver is not maintained anymore by his author... Sorry!
                                            <br />
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <a name="invalidreparse"></a>
                                        <span class="ascode">!+r (0x00001129) d:\src\invalid_reparse</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            Windows supports a dozen of Reparse Points. Well known is the use of reparse points for symbolic links,
                                            junctions and mountpoints, but there are
                                            <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa365511%28v=vs.85%29.aspx">a lot more</a>
                                            which are not supported by ln.exe because the data contained in the reparse point is undocumented or proprietary.
                                            <br />
                                            ln.exe <a href="#faq05">copies</a> the file referenced by such a reparse point only when used with the <a href="#unroll">--unroll</a>
                                            option, otherwise the error message ERROR_REPARSE_TAG_INVALID aka 0x1129 is printed.
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <a name="errortoomanylinks"></a>
                                        <span class="ascode">!+h (0x00000476) d:\src\toomanylinks</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            NTFS puts a 1023 limit on the number of hardlinks for one item. If ln runs into the problem, that the 1024th hardlink on
                                            an item should be created, it throws the ERROR_TOO_MANY_LINKS message aka 0x00000476.
                                            <a href="#1023safe">See also</a>
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <a name="markermergefailed"></a>
                                        <span class="ascode">!&degf (0x0000xxxx) d:\src\file2merge</span>
                                    </td>
                                    <td class="bodytext">
                                        <p>
                                            If a file can not be accessed during merge of .e.g two delorean sets this message along with the error code is thrown.
                                            <a href="#1023safe">See also</a>
                                        </p>
                                        <p>
                                        </p>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">'Entering on the fly dupemerge</span>
                                    </td>
                                    <td class="bodytext">
                                        ln.exe was forced into on the fly dupemerge mode.
                                        <br />
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode">'Sleeping %d sec: Destination is a remote drive</span>
                                    </td>
                                    <td class="bodytext">
                                        <a name="smb2redirectorcache"></a>
                                        There is an issue with <a href="https://technet.microsoft.com/en-us/library/ff686200%28WS.10%29.aspx">SMB2 Redirector Caches</a>,
                                        where ln.exe needs to wait during Delorean Copy for about 5 seconds until it can continue.
                                        <p>
                                            The point here is that ln.exe creates a hardlinks on a SMB2 drive, Windows Reports everything is fine, one can list the hardlinks,
                                            but as soon as one opens the hardlink within the time specified in HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Lanmanworkstation\Parameters
                                            an ERROR_FILE_NOT_FOUND (0x02) will be returned.<br />
                                            To overcome this ln.exe waits for the time specified in HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Lanmanworkstation\Parameters.
                                        </p>
                                    </td>
                                </tr>

                            </table>
                            <br /><br />

                            <b>Statistics</b><br />
                            <p>
                                After DeLorean Copy is finished it displays a statistics like this:
                            </p>
                            <table class="outputtable">
                                <tr>
                                    <td align="right" width="80">
                                        &nbsp;
                                    </td>
                                    <td align="right" width="80">
                                        Total
                                    </td>
                                    <td align="right" width="80">
                                        Copied
                                    </td>
                                    <td align="right" width="80">
                                        Linked
                                    </td>
                                    <td align="right" width="80">
                                        Skipped
                                    </td>
                                    <td align="right" width="80">
                                        Removed
                                    </td>
                                    <td align="right" width="80">
                                        Excluded
                                    </td>
                                    <td align="right" width="80">
                                        Failed
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        Folder:
                                    </td>
                                    <td align="right" width="80">
                                        10
                                    </td>
                                    <td align="right" width="80">
                                        1
                                    </td>
                                    <td align="right" width="80">
                                        -
                                    </td>
                                    <td align="right" width="80">
                                        6
                                    </td>
                                    <td align="right" width="80">
                                        1
                                    </td>
                                    <td align="right" width="80">
                                        3
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        File:
                                    </td>
                                    <td align="right" width="80">
                                        1050
                                    </td>
                                    <td align="right" width="80">
                                        1026
                                    </td>
                                    <td align="right" width="80">
                                        4
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                    <td align="right" width="80">
                                        3
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                    <td align="right" width="80">
                                        20
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        Junction:
                                    </td>
                                    <td align="right" width="80">
                                        7
                                    </td>
                                    <td align="right" width="80">
                                        -
                                    </td>
                                    <td align="right" width="80">
                                        2
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                    <td align="right" width="80">
                                        2
                                    </td>
                                    <td align="right" width="80">
                                        3
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        Symlink:
                                    </td>
                                    <td align="right" width="80">
                                        8
                                    </td>
                                    <td align="right" width="80">
                                        -
                                    </td>
                                    <td align="right" width="80">
                                        2
                                    </td>
                                    <td align="right" width="80">
                                        5
                                    </td>
                                    <td align="right" width="80">
                                        1
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                    <td align="right" width="80">
                                        1
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        Byte:
                                    </td>
                                    <td align="right" width="80">
                                        458200
                                    </td>
                                    <td align="right" width="80">
                                        272600
                                    </td>
                                    <td align="right" width="80">
                                        185600
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                    <td align="right" width="80">
                                        1392
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                    <td align="right" width="80">
                                        0
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="7">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        &nbsp;
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        Overall
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        Clone
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        Mirror
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="80">
                                        Times:
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        00:00:02.621
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        00:00:02.559
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        00:00:00.062
                                    </td>
                                </tr>
                            </table>

                            <br />
                            <p>
                                The statistics of DeLorean Copy only counts the operations which are performed during the
                                Mirror phase between Source and Backup(n+1). The operations which are performed during
                                cloning between <i>Backup(n)</i> and <i>Backup(n+1)</i> are not counted in the final DeLorean Copy statistics.<br />
                            </p>

                            <p>
                                <b>Total:</b> The total number of items as they were found under the <i>Source</i>. <i>Total</i>
                                is the sum of all other columns but the <i>Removed</i> column.
                            </p>
                            <p><b>Copied:</b></p>
                            <ul>
                                <li>Items prefixed with + in the verbose output and which were were copied from <i>Source</i> to <i>Backup</i></li>
                                <li>
                                    Items prefixed with & in the verbose output and which have turned out to be dangling Junctions
                                    or Symbolic Links in the <i>Backup</i>
                                </li>
                            </ul>
                            <p><b>Linked:</b></p>
                            <ul>
                                <li>Items prefixed with * in the verbose output which were either hardlinks or</li>
                                <li>Items prefixed with + in the verbose output which were symbolic links</li>
                            </ul>
                            <p><b>Skipped:</b></p>
                            <ul>
                                <li>
                                    Items prefixed with = in the verbose output, which were skipped during copy, because they were already there
                                </li>
                            </ul>
                            <p><b>Removed:</b></p>
                            <ul>
                                <li>
                                    Items prefixed with - in the verbose output, and which were removed from <i>Backup</i> because
                                    they are not in the <i>Source</i> any more.
                                </li>
                            </ul>
                            <b>Excluded:</b>
                            <ul>
                                <li>
                                    Items prefixed with ~ in the verbose output and which were excluded from <i>Backup</i>, because
                                    they were excluded from the <i>Source</i> via <a href="#excludewildcardsfiles">--exclude</a>.
                                </li>
                                <li>
                                    Items prefixed with # in the verbose output, because <a href="#splice">--splice</a>/<a href="#unroll">--unroll</a>
                                    was specified with a regular expression, but the regexp didn't match.
                                </li>
                                <li>
                                    Items prefixed with # in the verbose output, because no --unroll or --splice was given at all, thus it was
                                    <a href="#crop">cropping</a>.
                                </li>
                            </ul>

                            <p><b>Failed:</b></p>
                            <ul>
                                <li>The number of items which failed during creation.</li>
                                <li>The number of items which failed during cleaning while doing SmartMirror and while doing Delorean Copy.</li>
                            </ul>
                            <p>
                                <b>Overall:</b>
                                Time used up for the whole DeLorean Copy including the Clone from
                                <i>Backup(n)</i> to <i>Backup(n+1)</i> and the Mirror from <i>Source</i> to <i>Backup(n+1)</i><br />
                            </p>

                            <p>
                                <b>Clone:</b>
                                Time used up for the Clone from <i>Backup(n)</i> to <i>Backup(n+1)</i>
                            </p>

                            <p>
                                <b>Mirror:</b> Time used up for the Mirror from <i>Source</i> to <i>Backup(n+1)</i>
                            </p>

                            <br />
                            <b>Limitations</b>
                            <p>
                                It is little known, but NTFS has a limit to create a maximum of 1023 hardlinks to
                                one file. For DeLorean Copy this means that it will display an error message if
                                this limit is exceeded, because exceeding this limit means loss of data among the
                                most recent backup sets:
                            </p>
                            <br />
                            <a name="deloreanfailed1023"></a>
                            <font face="courier" color="red">
                                <b>
                                    Delorean Copy FAILED! The NTFS link
                                    limit of 1023 has been exceeded for:
                                </b>
                            </font><br />
                            <br />
                            <p>
                                The reason for exceeding this limit could either be, that there have been more than
                                1023 backup sets but no hardlinks within the <i>Source</i>, or there are hardlinks
                                within the <i>Source</i> and less than 1023 backup sets.
                                <a href="#1023safe">See also</a>
                            </p>

                            <p>
                                The filters of <a href="#includewildcardsfiles">--includeXXX</a> or
                                <a href="#excludewildcardsfiles">--excludeXXX</a> are applied in the source and the destination location
                            </p>

                            <br />
                            <b>Shell Integration</b>
                            <p>
                                DeLorean Copy functionality is also available via
                                <a href="https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html#deloreancopy"> Link Shell Extension </a>
                            </p>
                            <b>Anchor and Destination</b>
                            <p>
                                DeLorean Copy might need <a href="#anchor"> --anchor </a> and/or <a href="#destination">--destination</a> if there are
                                inner junctions / symbolic links among the source and the source dir is not referenced via its native name (e.g. X:\path ), but via UNC Shares
                                or <a href="#volumeguidsupport">GLOBALROOT / Volumeguid </a>due to operation via <a href="#snapshotservice"> snapshotservice</a>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br /><br />
                        </td>
                    </tr>

                    <!-- Destination -->
                    <tr>
                        <td class="hanger2">
                            <a name="destination"><b>--destination</b><br />Specify Destination</a>
                        </td>

                        <td align="left" class="bodytext">
                            <p>
                                In general ln.exe operates on source/target pairs. The default pair is always provided via e.g.<br />
                            </p>

                            <span class="ascode">
                                --copy SourceDir TargetDir, or --mirror SourceDir TargetDir<br />
                            </span>

                            <br />
                            --anchor AnchorDir provides an extra pair, but without --destination it uses the current target as second part of the pair .e.g<br /><br />
                            <span class="ascode">
                                --anchor AnchorDir --copy SourceDir TargetDir<br /><br />
                            </span>
                            creates two pairs<br />
                            <ul>
                                <li>SourceDir/TargetDir</li>
                                <li>AnchorDir/TargetDir</li>
                            </ul>
                            To modify the pair AnchorDir/TargetDir one must provide --destination:<br /><br />
                            <span class="ascode">
                                --anchor AnchorDir --Destination DestinationDir --copy SourceDir TargetDir<br /><br />
                            </span>
                            so that the pairs now are
                            <ul>
                                <li>SourceDir/TargetDir</li>
                                <li>AnchorDir/DestinationDir</li>
                            </ul>
                            <p>
                                The --destination option can only be used in combination with the <a href="#destinationusage">
                                    --source option<a />, or the <a href="#anchor"> --anchor option<a /><br />
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br /><br />
                        </td>
                    </tr>

                    <!-- Dupemerge -->
                    <tr>
                        <td class="hanger2">
                            <a name="dupemerge"><b>--dupemerge</b><br />On the fly Dupemerge</a>
                        </td>
                        <td class="bodytext">
                            <p>
                                <a href="#smartcopy">Smart Copy</a>, <a href="#smartmirror">Smart Mirror</a> and
                                <a href="#smartclone">SmartClone</a> rely on finding the hardlink relations by enumerating the unique file-index
                                attribute of each file. But there might be more equal files below a given path, some of them probably not hardlinked.
                                When issuing the --dupemerge option ln.exe does not only rely on the file-indices, but also creates incremental hash sums
                                on all files, so that it finds additional not yet hardlinked dupes and hardlinks them in the destination:
                            </p>
                            <br />

                            <img src="ontheflydupemerge.png" alt="Smartcopy with On the fly Dupemerge" />
                            <br /><br />


                            e.g.:
                            <br />
                            <span class="ascode">
                                ln --dupemerge --copy Folder1 Destination\Folder1
                            </span>
                            <p>
                                <!--eng-->
                                In the above example the directory <i>Folder1</i> is searched for dupes and copied/hardlinked to <i>destination</i>.
                                The files A, C, D are already hardlinked in the source, but B is not, even if it is the same as A,C,D. Similar situation with E,F,
                                which are already hardlinked, but G is the same as E,F but not hardlinked. In the destination all equal files are hardlinked:
                                There is a dupel B,C,D and a dupel E,F,G. A was omitted as in normal Smartcopy, because it is out of the source scope.
                                <!--/eng-->
                            </p>
                            <br />

                            <b>Broken NTFS implementations</b>
                            <p>
                                The <i>--dupemerge</i> option is also of help, when data from a drive should be copied which has a broken NTFS implementation.<br />
                                NTFS drives which are accessed via SMB or CIFS sometimes show the same file-index attribute for files of different size. Well that's impossible, because
                                the file-index attribute can only be the same for hardlinks, and hardlinks, since they are pointing to the same data, <b>are</b> the same files,
                                with for sure the same size.
                            </p>
                            <p>
                                So the SMB or CIFS implementation of such drives is broken, and this means one can not detect already existing hardlinks by reading
                                all file-indices from all files and searching for equal indices. ln.exe has a built in <a href="#error0585">sanity check</a> on file-indices, and once it finds files
                                with same file-index but different size, it assumes the view on this NTFS drive is broken, and invalidates all file-indices, thus assuming no
                                hardlinks are on this drive.
                            </p>

                            <p>
                                In such a situation <i>--dupemerge</i> is of great help because it scans the given path and calculates incremental MD5 hash sums for all
                                files. This enables ln.exe to detect dupes, and hardlink equal files in the destination.
                            </p>

                            <p>
                                On the fly Dupemerge can take a while and ln.exe prints out a warning, that it entered the <i>On the Fly Dupemerge mode.</i><br />
                                The <a href="https://schinagl.priv.at/nt/dupemerge/dupemerge.html">Dupemerge functionality</a> can also be downloaded as a standalone tool for
                                in-place dupemerge.
                            </p>

                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <br />
                        </td>
                    </tr>


                    <!-- Enum -->
                    <tr>
                        <td class="hanger2">
                            <a name="enumhardlinks"><b>--enum</b><br />Enum hardlinks</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                Sometimes it is convenient to find out which files
                                are linked together, because hardlinked files might be spread around a NTFS volume.
                                This is somehow the inverse hardlink functionality and it can be invoked as follows.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --enum x:\path
                            </span>
                            <p>
                                In the above example files below <i>path</i> are searched, and the files which are hardlinked are printed out.
                            </p>
                            <p>
                                The --enum option first prints so called <i>saturated</i> and afterwards <i>unsaturated</i>
                                hardlinks. For <i>saturated</i> hardlinks the number of files found below <i>path</i>
                                matches the hardlink reference count of these files, but <i>unsaturated</i> hardlinks
                                have a reference count greater than the number found below <i>path</i>.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>



                    <!-- Exclude-->
                    <tr>
                        <td class="hanger2">
                            <a name="excludewildcardsfiles"><b>--exclude</b><br />Exclude files via wildcards</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                In certain situations not all files below a path should
                                be used in Smart Copy, Smart Mirror, Delorean Copy or Clone. To accomplish this ln.exe
                                can be run with wildcards specified to exclude certain files.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --exclude *.ocx --exclude *.dll --delorean c:\source d:\b\dest d:\b\bk1
                            </span>
                            <p>
                                Basically any arbitrary wildcard expressions can be used, because the wildcard expressions are translated into a
                                regular expression. This means that e.g *file*.ext*.* is also a valid wildcard expression for --exclude.
                            </p>
                            <br />
                            <p>
                                Sometimes it is necessary to just exclude certain files along a given path:
                            </p>

                            <span class="ascode">
                                ln --exclude "*\\Res\\*\\Logfile.t*" --copy c:\source d:\b\dest
                            </span>
                            <br />

                            <p>
                                The above example excludes all files <i>Logfile.*</i> from all directories which have <i>\Res\</i> in it.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --exclude @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                <span class="ascode">
                                    <br />*.dll
                                    <br />*.ocx
                                    <br />Myfile*.*
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- excludedir -->
                    <tr>
                        <td class="hanger2">
                            <a name="excludewildcardsdirectories"><b>--excludedir</b><br />Exclude directories via wildcards</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                In certain situations not all directories should be used in Smart Copy, Smart Mirror, Delorean Copy
                                or Clone. To accomplish this ln.exe can be run with wildcards to exclude certain directories.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --excludedir *test* --delorean c:\source d:\b\dest d:\b\bk1
                            </span>
                            <p>
                                Basically any arbitrary wildcard expressions can be used, because
                                the wildcard expressions are translated into a regular expression. This means that e.g *file*.ext*.*
                                is also a valid wildcard expression for --excludedir.
                                Wildcard expression shall not span more than one directory level: e.g. *fotos\\temp* will not succeed.
                            </p>
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --excludedir @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                <span class="ascode">
                                    <br />*fotos*
                                    <br />aDir
                                    <br />Directory with blanks
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>


                    <!-- excluderegexp -->
                    <tr>
                        <td class="hanger2">
                            <a name="excluderegexpsfiles"><b>--excluderegexp</b><br />Exclude files via regular expressions</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                In certain situations not all files below a path should
                                be used in Smart Copy, Smart Mirror, Delorean Copy or Clone. To accomplish this ln.exe
                                can be run with regular expressions specified to exclude certain files.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --excluderegexp "[a-z]*" --copy c:\source d:\b\dest
                            </span>
                            <br />
                            <p>
                                The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                    POSIX 1003.2 extended RE (ERE) syntax
                                </a>. They are not casesensitiv.
                            </p>
                            <p>
                                The regular expression specified under --excluderegexp is applied to the whole path with the filename.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --excluderegexp @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a regular expression. e.g.
                                <span class="ascode">
                                    <br />[a-z]*
                                    <br />file[0-9]\.txt
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- excluderegexpdir -->
                    <tr>
                        <td class="hanger2">
                            <a name="excluderegexpsfordirectories"><b>--excluderegexpdir</b><br />Exclude directories via regular expressions</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                In certain situations not all directories should
                                be used with Smart Copy, Smart Mirror, Delorean Copy or Clone. To accomplish this ln.exe
                                can be run with regular expressions to exclude certain directories.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --excluderegexpdir "[a-z]*" --delorean c:\source d:\b\dest d:\b\bk1
                            </span>
                            <p>
                                The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                    POSIX 1003.2 extended RE (ERE) syntax
                                </a>. They are not casesensitiv.
                            </p>
                            <p>
                                The regular expression specified under --excluderegexpdir is applied to the whole path with the filename.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --excluderegexpdir @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a regular expression. e.g.
                                <span class="ascode">
                                    <br />[a-z]*
                                    <br />directory[0-9]
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- follow -->
                    <tr>
                        <td class="hanger2">
                            <a name="follow"><b>--follow</b><br />follow based on wildcards</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                The <a href="#deloreandelete">delete</a> option normally stops on reparse boundaries, but in
                                certain cases it is useful to force the --delete option to follow pathes, which match wildcards
                            </p>
                            <br />
                            <span class="ascode">
                                ln --follow "Outer*" --delete "Folder 1"
                            </span>
                            <br />
                            <br />
                            <br />
                            <img src="deletefollow.png" alt="Delete stops on reparse boundaries" />
                            <br />
                            <br />
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --follow @List.txt --delete MyPath
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                <span class="ascode">
                                    <br />Outer*
                                    <br />WhatEver
                                    <br />Somethi?g*
                                    <br />Directory with blanks
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- followregexp -->
                    <tr>
                        <td class="hanger2">
                            <a name="followregexp"><b>--followregexp</b><br />follow based on<br />regular expressions<br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                The <a href="#deloreandelete">delete</a> option normally stops on reparse boundaries, but in
                                certain cases it is useful to force the --delete option to follow pathes, which match regular expressions
                            </p>
                            <br />
                            <span class="ascode">
                                ln --followregexpr "[a-z]*" --delete "Folder 1"
                            </span>
                            <br />
                            <br />
                            <p>
                                The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                    POSIX 1003.2 extended RE (ERE) syntax
                                </a>. They are not casesensitiv.
                            </p>
                            <p>
                                The regular expression specified under --followregexp is applied to the whole path with the filename.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --followregexpr @List.txt --delete MyPath
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a regular expression. e.g.
                                <span class="ascode">
                                    <br />[a-z]*
                                    <br />file[0-9]\.txt
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>



                    <!-- include -->
                    <tr>
                        <td class="hanger2">
                            <a name="includewildcardsfiles"><b>--include</b><br />Include files via wildcards</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                To selectively run Smart Copy, Smart Mirror, Delorean Copy or Clone on a certain
                                set of files, the --include option can be used with wildcards.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --include *.ocx --include *.dll --delorean c:\source d:\b\dest d:\b\bk1
                            </span>
                            <br />
                            <p>
                                Basically any arbitrary wildcard expressions can be used, because the wildcard expressions are
                                translated into a regular expression. This means that e.g *file*.ext*.* is also a valid wildcard
                                expression for --include.
                            </p>
                            <p>
                                Sometimes it is necessary to just include certain files along a given path:
                            </p>
                            <span class="ascode">
                                ln --include "*\\Res\\*\\Logfile.t*" --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example includes all files <i>Logfile.*</i> from all directories which have <i>\Res\</i> in it.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --include @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                <span class="ascode">
                                    <br />*.dll
                                    <br />*.ocx
                                    <br />Myfile*.*
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- includedir -->
                    <tr>
                        <td class="hanger2">
                            <a name="includewildcardsdirectories"><b>--includedir</b><br />Include directories via wildcards<br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                To selectivley run Smart Copy, Smart Mirror, Delorean Copy or Clone on a certain
                                set of directories, the --includedir option can be used with wildcards.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --includedir *test --delorean c:\source d:\b\dest d:\b\bk1
                            </span>
                            <p>
                                Basically any arbitrary wildcard expressions can be used, because
                                the wildcard expressions are translated into a regular expression. This means that e.g *ub?older*
                                is also a valid wildcard expression for --includedir.
                                Wildcard expression shall not span more than one directory level: e.g. *fotos\\temp* will not succeed
                            </p>
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --includedir @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a matching pattern. e.g.
                                <span class="ascode">
                                    <br />*fotos*
                                    <br />aDir
                                    <br />Directory with blanks
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>


                    <!-- includeregexp -->
                    <tr>
                        <td class="hanger2">
                            <a name="includeregexpsfiles"><b>--includeregexp</b><br />Include files<br />via regular expressions<br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                To selectively run Smart Copy, Smart Mirror, Delorean Copy or Clone on a certain set of files, the
                                --includeregexp option can be used with regular expressions specified to include certain files.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --includeregexp "[a-z]*" --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                    POSIX 1003.2 extended RE (ERE) syntax
                                </a>. They are not casesensitiv.
                            </p>
                            <p>
                                The regular expression specified under --includeregexp is applied to the whole path with the filename.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --includeregexp @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a regular expression. e.g.
                                <span class="ascode">
                                    <br />[a-z]*
                                    <br />file[0-9]\.txt
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- includeregexpdir -->
                    <tr>
                        <td class="hanger2">
                            <a name="includeregexpsfordirectories"><b>--includeregexpdir</b><br />Include directories<br />via regular expressions<br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                To selectively run Smart Copy, Smart Mirror, Delorean Copy or Clone on a certain set of directories, the --includeregexpdir
                                option can be used with regular expressions to include certain directories.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --includeregexpdir "[a-z]*" --delorean c:\source d:\b\dest d:\b\bk1
                            </span>
                            <p>
                                The regular expressions used must conform to <a href="https://laurikari.net/tre/documentation/regex-syntax">
                                    POSIX 1003.2 extended RE (ERE) syntax
                                </a>. They are not casesensitiv.
                            </p>
                            <p>
                                The regular expression specified under --includeregexpdir is applied to the whole path with the filename.
                            </p>
                            <br />
                            <p>
                                This option supports taking its arguments from file.
                            </p>
                            <span class="ascode">
                                ln --includeregexpdir @List.txt --copy c:\source d:\b\dest
                            </span>
                            <p>
                                The above example references to a file <i>List.txt</i>, which on every line contains a regular expression. e.g.
                                <span class="ascode">
                                    <br />[a-z]*
                                    <br />directory[0-9]
                                </span>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- json -->
                    <tr>
                        <td class="hanger2">
                            <a name="json"><b>--json</b><br />Print output<br />in JSON<br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                To postprocess the results of ln.exe the whole output can be switched to Json.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --json --copy x:\source d:\destination
                            </span>
                            <p>
                                The output looks like this
                            </p>
                            <span class="ascode">
                                <br />
                                { <br />
                                &nbsp;&nbsp;"Statistics": [ <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;{ <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Items": [ <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"op": "#", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"er": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ty": "s", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"pa": "D:\\path\\ln64_104.exe" <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;], <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Summary": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Total": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Folder": 1, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Junction": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Mountpoint": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReparseUnknown": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Symlink": 1, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Byte": 0 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Copied": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Folder": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Junction": "-1", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Mountpoint": "-1", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReparseUnknown": "-1", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Symlink": "-1", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Byte": 0 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Linked": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Folder": "-1", <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Junction": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Mountpoint": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReparseUnknown": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Symlink": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Byte": 0 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Skipped": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Folder": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Junction": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Mountpoint": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReparseUnknown": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Symlink": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Byte": 0 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Excluded": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Folder": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Junction": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Mountpoint": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReparseUnknown": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Symlink": 1, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Byte": 0 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Failed": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Folder": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"File": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Junction": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Mountpoint": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReparseUnknown": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Symlink": 0, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Byte": 0 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Times": { <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Overall": 191267 <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />
                                &nbsp;&nbsp;&nbsp;&nbsp;} <br />
                                &nbsp;&nbsp;]<br />
                                }
                            </span>

                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- junction -->
                    <tr>
                        <td class="hanger2">
                            <a name="junctions"><b>--junction</b><br />Create Junctions</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                ln.exe can also create junctions, and print the target of junctions
                            </p>
                            <br />

                            <span class="ascode">
                                ln --junction JunctionName TargetDirectory
                            </span>
                            <p>
                                In the above example a junction <i>JunctionName</i> is created, which points to <i>TargetDirectory</i>
                            </p>
                            <br />

                            <span class="ascode">
                                ln --junction JunctionName
                            </span>
                            <p>
                                In the above example the junction <i>JunctionName</i> is searched for its Target and the
                                target is printed out.
                            </p>
                            <br />

                            <span class="ascode">
                                rd JunctionName
                            </span>
                            <br />
                            <p>
                                In the above example the junction <i>JunctionName</i> is removed. This is accomplished with an simple
                                built in command prompt command.
                            </p>

                            <a name="junctionvolumeguid"></a>
                            <span class="ascode">
                                ln --junction JunctionName \\?\Volume{f6c8b244-1ce4-11e0-a607-005056c00008}\tmp
                            </span>
                            <br />
                            <p>
                                In the above example the junction <i>JunctionName</i> is created to a volume-guid target.
                                This is useful if you are either out of drive letters, or just want to have a link to a directory on a
                                mounted drive regardless of which drive-letter it is mounted on. To find out the available volume-guids
                                use the mountvol.exe command.
                            </p>

                            Pushing this idea further you can now mount whole volumes onto arbitrary locations in your filesystem, even
                            if the volume is not mounted to a drive letter at all:<br />
                            <ul>
                                <li>Format the disk in 'Disk Manager', but do not mount at all in 'Disk Manager'</li>
                                <li>Use mountvol.exe to see which volumes are available.</li>
                                <li>
                                    Mount the volume:<br />
                                    <span class="ascode">
                                        ln --junction Mountpoint \\?\Volume{f6c8b244-1ce4-11e0-a607-005056c00008}\
                                    </span>
                                    <br />
                                </li>
                                <li>Use 'rmdir Mountpoint' to unmount.</li>
                            </ul>

                            <br />
                            <p>
                                In the early days of ln.exe the arguments of --junction were unfortunately defined in the opposite order
                                as for --symbolic. So --junction has the target as first argument and --symbolic has it as second. So far so bad.
                                To fix this and avoid breaking compatibility (and keep my regression test simple;-) for --junction an additional option --noitcnuj was introduced, which creates
                                junctions and has the target as its second argument:
                            </p>

                            <span class="ascode">
                                ln --noitcnuj \\?\Volume{f6c8b244-1ce4-11e0-a607-005056c00008}\tmp JunctionName
                            </span>

                            <p>
                                So everything which can be done with --junction can be done with --noitcnuj, but reversed argument order.
                                Why 'noitcnuj'? Read noitcnuj backwards ... ;-)
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>


                    <!-- keepsymlinkrelation -->
                    <tr>
                        <td class="hanger2">
                            <a name="keepsymlinkrelation"><b>--keepsymlink<br />relation</b><br />Save absolute/<br />relative status</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                Symbolic links can be created either <a href="#absolutesymboliclinks">absolute or relative</a>. Setting this modifier creates
                                symbolic links in the destination in the same way as the were in the source.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --keepsymlinkrelation --copy x:\source x:\destination
                            </span>
                            <p>
                                This modifier can be applied to all operation like --copy, --mirror, or --delorean. It is
                                enabled by default if ln.exe is used with the <a href="#backup">--backup</a> option.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- list -->
                    <tr>
                        <td class="hanger2">
                            <a name="listsiblings"><b>--list</b><br />List Hardlink<br />siblings</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                With Windows7 and above finding out the siblings of a hardlink is very simple and needs no time-consuming
                                operations
                            </p>
                            <br />
                            <span class="ascode">
                                ln --list filename
                            </span>
                            <br />
                            <p>
                                In the above example the hardlink siblings for <i>filename</i> are printed
                                out.
                            </p>
                            <p>
                                With XP, W2K or W2K3 finding the hardlink siblings now also works, but it takes
                                more time, because in the worst case the whole logical volume must be searched.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- merge -->
                    <tr>
                        <td class="hanger2">
                            <a name="merge"><b>--merge</b><br />Merge</a>
                        </td>
                        <td class="bodytext">
                            The merge function is needed if two trees shall be merged via hardlinks into one tree. Think of the following scenario:

                            <ul>
                                <li>A set of <a href="#deloreancopy">delorean</a> backups have been created on a disk, and the disk becomes full.</li>
                                <li>A new set of delorean backups from the same source is created on another disk.</li>
                                <li>The two sets shall be merged into one. So copy both sets via <a href="#smartcopy">smartcopy</a> to one disk and use the <i>merge</i> functionality</li>
                            </ul>
                            <br /><br />

                            <img src="deloreanmerge.png" alt="Merge two directories recursivley" />
                            <br /><br />

                            <p>
                                The above example assumes two DeloreanSets. DeloreanSet1 contains 2 Backups and DeloreanSet2 contains 1 Backup.
                                The DeloreanMerge operation hardlinks DeloreanSet2 into DeloreanSet1, so that DeloreanSet1 & DeloreanSet2 become one.
                            </p>

                            e.g.:<br />
                            <br />
                            <span class="ascode">
                                ln --merge x:\DeloreanSet1\bkp2 x:\DeloreanSet2\bkp3
                            </span>
                            <p>
                                In the above example the directory <i>x:\DeloreanSet1\bkp2</i> is merged with <i>x:\DeloreanSet2\bkp3</i>.
                            </p>

                            <p>
                                Merged files are marked with the <a href="#markermerge">&deg character</a> in the log.<br />
                                If the hardlink limit of 1023 was exceeded, the files are not merged, and they are prefixed in the output with <a href="#markermergeexceeded">&deg~</a><br />
                                If the files are already hardlinked, they are prefixed in the output with <a href="#markermergeexists">&deg=</a><br />
                                If something goes wrong during merging the affected files it is prefixed in the output with <a href="#markermergefailed">!&degf</a>
                            </p>

                            <p>
                                This option will not work on Network drives.<br /><br />
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <br />
                            <br />
                        </td>
                    </tr>

                    <!-- mirror -->
                    <tr>
                        <td class="hanger2">
                            <a name="smartmirror"><b>--mirror</b><br />Smart Mirror</a>
                        </td>
                        <td class="bodytext">
                            Smart Mirror is very similar to <a href="#smartcopy">Smart Copy</a> and not only copies but
                            <i>synchronises</i> the folder <i>Source</i> to <i>Destination</i>:
                            <ul>
                                <li>Smart Copy only different items from <i>Source</i> to <i>Destination.</i></li>
                                <li>Delete items no longer in <i>Source</i> from <i>Destination</i>.</li>
                            </ul>

                            <p>
                                Smart Mirror takes care of Hardlink Relations, restores Inner Junctions or Inner Symbolic links or when
                                issued <a href="#outerjunctionhandling">unrolls or splices</a> Outer Junctions or Outer Symbolic Links.
                                The time stamps for LastWriteTime, CreationTime and LastAccessTime of files/folders/junctions/symbolic links
                                are also restored at the corresponding destination locations during SmartMirror.
                            </p>
                            <p>
                                <i>Different Items</i> means: Either the file size changed, or the <i>LastWriteTime</i> changed.
                            </p>

                            e.g.:<br />
                            <br />
                            <span class="ascode">
                                ln --mirror x:\source x:\destination
                            </span>
                            <p>
                                In the above example the directory <i>x:\source</i> is mirrored to <i>x:\destination</i>,
                                and all symbolic links and junctions within <i>x:\destination</i> are updated with
                                respect to their new locations under <i>x:\destination</i>.
                            </p>

                            <p>
                                The filters of <a href="#includewildcardsfiles">--includeXXX</a> or <a href="#excludewildcardsfiles">--excludeXXX</a>
                                are applied in the source and the destination location
                            </p>

                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <br />
                            <p>
                                <b>Shell Integration</b><br />
                                Smart Mirror functionality is also available via <a href="https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html#smartmirror">
                                    Link Shell Extension
                                </a>
                            </p>
                            <br />
                        </td>
                    </tr>

                    <!-- Symbolic Clone Mirror -->
                    <tr>
                        <td class="hanger2">
                            <a name="clonemirror"><b>--mirror<br />--symbolic</b><br />Symbolic Clone<br /> Mirror</a>
                        </td>
                        <td class="bodytext">
                            The Clone Mirror function is a combination of <a href="#smartmirror">Smart Mirror</a> and
                            <a href="#smartclone">SmartClone</a>. Basically it creates a Symbolic Link Clone from Source to Destination directory,
                            but also <i>synchronises</i> the folder <i>Source</i> to <i>Destination</i>:
                            <ul>
                                <li>Create a symbolic link Clone from <i>Source</i> to <i>Destination.</i></li>
                                <li>Delete symbolic links in <i>Destination</i> which are no longer in <i>Source</i></li>
                            </ul>

                            <p>
                                Clone Mirror takes care of Inner Junctions, Inner Symbolic links or when
                                issued <a href="#outerjunctionhandling">unrolls or splices</a> Outer Junctions or Outer Symbolic Links.<br />
                                <i>Different Items</i> means: The <i>LastWriteTime</i> has changed.
                            </p>

                            e.g.:<br />
                            <span class="ascode">
                                ln --symbolic --mirror x:\source x:\destination
                            </span>
                            <p>
                                In the above example the directory <i>x:\source</i> is cloned to <i>x:\destination</i>,
                                and all symbolic links and junctions within <i>x:\destination</i> are updated with
                                respect to their new locations under <i>x:\destination</i>. Furthermore symbolic links, which are in the
                                Destination, but have no longer a target in the Source, are deleted from the Destination.
                            </p>

                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <br />
                        </td>
                    </tr>

                    <!-- Hardlink Clone Mirror -->
                    <tr>
                        <td class="hanger2">
                            <a name="hardlinkclonemirror"><b>--mirror<br />--recursive</b><br />Hardlink Clone<br /> Mirror</a>
                        </td>
                        <td class="bodytext">
                            The Hardlink Clone Mirror function is a combination of <a href="#smartmirror">Smart Mirror</a> and
                            <a href="#smartclone">SmartClone</a>. Basically it creates a Hardlink Clone from Source to Destination directory,
                            but also <i>synchronises</i> the folder <i>Source</i> to <i>Destination</i>:
                            <ul>
                                <li>Create a Hardlink Clone from <i>Source</i> to <i>Destination.</i></li>
                                <li>Delete Hardlinks in <i>Destination</i> which are no longer in <i>Source</i></li>
                            </ul>

                            <p>
                                Hardlink Clone Mirror takes care of Inner Junctions, Inner Symbolic links or when
                                issued <a href="#outerjunctionhandling">unrolls or splices</a> Outer Junctions or Outer Symbolic Links.<br />
                                <i>Different Items</i> means: The <i>LastWriteTime</i> has changed.
                            </p>

                            e.g.:<br />
                            <span class="ascode">
                                ln --recursive --mirror x:\source x:\destination
                            </span>
                            <p>
                                In the above example the directory <i>x:\source</i> is cloned to <i>x:\destination</i>,
                                and all symbolic links and junctions within <i>x:\destination</i> are updated with
                                respect to their new locations under <i>x:\destination</i>. Furthermore files, which are in the
                                Destination, but are no longer in the Source, are deleted from the Destination.
                            </p>

                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <br />
                        </td>
                    </tr>

                    <!-- move -->
                    <tr>
                        <td class="hanger2">
                            <a name="smartmove"><b>--move</b><br />Smart Move</a>
                        </td>
                        <td class="bodytext">
                            <p>
                                Smart Move enables folders with junctions and symbolic links beneath to be renamed, and the junctions
                                and symbolic links' targets are updated below that folder. Without Smart Move renaming of such folders
                                would end in dangling junctions and symbolic links.
                            </p>
                            <p>
                                With junctions or symbolic link directories it behaves as follows:
                            </p>
                            <img src="smartmovehowto.png" alt="Smart Move behaviour for junctions and symbolic links" />
                            <p>
                                By closely looking at the above picture one can find three different types of folders/junctions:
                            </p>
                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="hanger2">
                                        <b>Normal Folders</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder 'Folder 3' is a normal folder. It gets moved with its content straight forward.
                                        </p>
                                        <br />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="hanger2">
                                        <b>Inner Junctions<br />Symlinks</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder 'Inner Junction/Symlink' is targeted at 'Inner Junction/Symlink Target'. In ln.exe terms this
                                            kind of folder is called <i> Inner Junction/Symlink</i>, because its target points to a folder, which is below
                                            the common anchor 'Folder 1'.
                                        </p>
                                        <p>
                                            <i>Inner Junctions/Symlinks</i> are updated properly via Smart Move in the destination location.
                                        </p>
                                        <br />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="hanger2">
                                        <b>Outer Junctions<br />Symlinks</b>
                                    </td>
                                    <td align="left" class="bodytext">
                                        <p>
                                            The folder 'Outer Junction/Symlink' is targeted at the folder 'Outer Junction/Symlink Target'. In LSE
                                            terms this kind of folder is called <i>Outer Junction/Symlink</i>, because its target points to a folder,
                                            which is in parallel and thus outside the anchor 'Folder 1'.
                                        </p>
                                        <p>
                                            <i>Outer Junction/Symlink</i> are not touched by Smart Move and thus stay connected
                                            to their respective target. Please note that this is different to Smart Copy, which
                                            has <a href="#outerjunctionhandling">3 different ways</a> to deal with Outer Junctions/Symlinks.
                                        </p>
                                    </td>
                                </tr>
                            </table>

                            <br />
                            e.g.:
                            <br /><br />
                            <span class="ascode">
                                ln --move x:\dir\dir2 x:\dir\newdir
                            </span>
                            <p>
                                In the above example the directory <i>x:\dir\dir2</i> is moved to <i>x:\dir\newdir</i>,
                                and all symbolic links and junctions within <i>x:\dir\dir2</i> are updated with
                                respect to their new locations under <i>x:\dir\newdir</i>.
                            </p>

                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>.
                            </p>
                            <p>
                                <b>Shell Integration</b><br />
                                Smart Move functionality is also available via <a href="https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html#smartmove">
                                    Link Shell Extension
                                </a>
                            </p>
                            <br />
                        </td>
                    </tr>


                    <!-- noads-->
                    <tr>
                        <td class="hanger2">
                            <a name="noads"><b>--noads</b><br />Skip ADS</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                The --noads option tells ln.exe not to copy Alternative Data Streams (ADS) of files and directories.
                                This option can be useful if the destination supports NTFS, but can not deal with ADS, which happens
                                on certain NAS drives.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --noads --copy src dest
                            </span>
                            <p>
                                In the above example the files are copied normally from <i>src</i> to <i>dest</i> except for ADS.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- noea-->
                    <tr>
                        <td class="hanger2">
                            <a name="noea"><b>--noea</b><br />Skip EA Records</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                The --noea option tells ln.exe not to copy EA Records of files and directories.
                                This option can be useful if the destination supports NTFS, but can not deal with EA Records,
                                which happens on certain NAS drives.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --noea --copy src dest
                            </span>
                            <p>
                                In the above example the files are copied normally from <i>src</i> to <i>dest</i> except for EA Records.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- output-->
                    <tr>
                        <td class="hanger2">
                            <a name="output"><b>--output</b><br />Redirect<br />Output</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                The output of ln.exe can be redirected to files via this commandline option
                            </p>
                            <br />
                            <span class="ascode">
                                ln --output filename --copy src dest
                            </span>
                            <p>
                                In the above example all output is redirected to <i>filename</i>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- probefs-->
                    <tr>
                        <td class="hanger2">
                            <a name="probefs"><b>--probefs</b><br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                This option of ln.exe returns the type of the filesystem. e.g NTFS, FAT, ReFs ...
                            </p>
                            <p>
                            </p>
                            <span class="ascode">
                                ln --probefs x:\
                            </span>
                            <br />
                            <span class="ascode">
                                ln --probefs \\server\share\path
                            </span>
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>



                    <!-- progress-->
                    <tr>
                        <td class="hanger2">
                            <a name="progress"><b>--progress</b><br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                This option is a modifier and shows the progress during operations like
                                <a href="#smartmirror">--mirror</a>,
                                <a href="#smartcopy">--copy</a>,
                                <a href="#smartclone">--clone</a>,
                                <a href="#deloreancopy">--delorean</a>
                            </p>
                            <p>
                            </p>
                            <span class="ascode">
                                ln --progress --output foo.txt --copy src dest
                            </span>
                            <p>
                                The --progress option writes the progress only onto the console and is best used with --ouput. The --output option collects all
                                important logging in a logfile, while the progress is written onto the console. e.g.:
                            </p>
                            <span class="ascode">
                                <br />
                                Enumerating ... \ <br />
                                Copying ...       12%, Time left: 00:00:42
                                <br />
                            </span>
                            <p>
                                The percentage progress is displayed as well as the estimated time left.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>



                    <!-- quiet-->
                    <tr>
                        <td class="hanger2">
                            <a name="quiet"></a><a name="loglevel"><b>--quiet</b><br />specify<br />log level</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                The amount of output during various operations can be controlled
                                via the --quiet switch:
                            </p>
                            <br />
                            <span class="ascode">
                                ln --quiet ...
                            </span>
                            <p>
                                The --quiet option without arguments totally disables any output during ln.exe' operations.<br />
                                To specify the amount of output an optional argument can be passed
                                to the --quiet switch:
                            </p>
                            <br />
                            <table cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><b>0</b></span>
                                    </td>
                                    <td class="bodytext">
                                        Completely suppress output. This is the if same as no argument would have been passed to --quiet.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><b>1</b></span>
                                    </td>
                                    <td class="bodytext">
                                        Only show severe errors.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><b>2</b></span>
                                    </td>
                                    <td class="bodytext">
                                        Show the changes, e.g if a file is copied additionally during delorean copy. Furthermore show severe errors.
                                    </td>
                                </tr>

                                <tr>
                                    <td class="bodytext">
                                        <span class="ascode"><b>3</b></span>
                                    </td>
                                    <td class="bodytext">
                                        Show all output available. This is same as --quiet has been ommitted.
                                    </td>
                                </tr>
                            </table>
                            <br />

                            <span class="ascode">
                                ln --quiet 2 ...
                            </span>
                            <p>
                                In the above example only changes are shown.
                            </p><br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- recursive-->
                    <tr>
                        <td class="hanger2">
                            <a name="smartclone"></a><a name="recursivesupport"><b>--recursive</b><br />Smart Clone</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                ln.exe can recursively hardlink all files found below a given directory location to a newly created directory
                                structure under a different location.
                            </p>
                            <p>
                                In other words this means, the given directory structure is rebuilt under a different location, and all files
                                from the given directory structure are hardlinked to the newly generated structure. Something like a xcopy,
                                but the files are hardlinked and not copied:
                            </p>
                            <br />
                            <img src="hardlinkcloneshowto.png" border="0" alt="Hardlink Clones how to" />

                            <br />
                            <p>
                                e.g.:
                            </p>
                            <span class="ascode">
                                ln --recursive x:\dir\dir2 x:\dir\newdir
                            </span>
                            <p>
                                In the above example the directories below <i>x:\dir\dir2</i> are rebuilt below <i>x:\dir\newdir</i>, and
                                all files from <i>x:\dir\dir2</i> are hardlinked to their corresponding locations under <i>x:\dir\newdir</i>.
                            </p>
                            <p>
                                A folder tree might also contain Junctions or Symbolic Links. The clone process
                                recreates <a href="#innerjunction">inner junction/symbolic</a> links at the destination
                                location very similar to the way SmartCopy does.
                            </p>
                            <br />

                            <img src="hardlinkclonessmart.png" alt="Hardlink Clones the smart way" />
                            <br />
                            <p>
                                Outer Junctions/Symbolic links are recreated with respect to the specified
                                <a href="#outerjunctionhandling">Outer Junction/Symbolic Link handling</a>. e.g.
                            </p>

                            <span class="ascode">
                                ln --unroll --recursive x:\dir\dir2 x:\dir\newdir
                            </span>
                            <p>
                                In the above example the directories below <i>x:\dir\dir2</i> are rebuilt below
                                <i>x:\dir\newdir</i>, all files from <i>x:\dir\dir2</i> are hardlinked to their
                                corresponding locations under <i>x:\dir\newdir</i> and all junctions/symbolic links
                                are <a href="#outerjunctionhandling">unrolled</a>.
                            </p>
                            <br />
                            <p>
                                The cloning process is also available with Symbolic Links instead of Hardlinks.
                            </p>
                            <img src="symlinkssmart.png" alt="Symbolic Link Clones the smart way" />
                            <br />
                            <p>
                                <b>Output</b>
                                See <a href="#output">Output</a> among Delorean Copy for a detailed description
                                of HardlinkClone's Output
                            </p>
                            <p>
                                <b>Shell Integration</b><br />
                                The recursive support or HardlinkClone functionality is also available via
                                <a href="https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html#smartclone"> Link Shell Extension </a>
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- skipfiles-->
                    <tr>
                        <td class="hanger2">
                            <a name="skipfiles"><b>--skipfiles</b><br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                This option is a modifier to Smart Copy, Smart Mirror, Delorean Copy, or Clone, so that only directories
                                symlinks and junctions are processed. The files are ommitted with this modifier used.
                            </p>
                            <span class="ascode">
                                ln --skipfiles --copy source destination
                            </span>
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- smartrename -->
                    <tr>
                        <td class="hanger2">
                            <a name="smartrename"><b>--smartrename</b><br />Smart Rename</a>
                        </td>
                        <td class="bodytext">
                            <p>
                                Smart Rename is very similar to <a href="#smartmove">Smart Move</a>, but
                                only renames junctions/symbolic links references below a given folder.
                            </p>
                            <br />
                            <span class="ascode">
                                ln --smartrename x:\dir\dir2 x:\dir\newdir
                            </span>
                            <br />
                            <p>
                                In the above example the symbolic links/junction references below <i>x:\dir\dir2</i> are renamed to <i>x:\dir\newdir</i>.
                                This leaves <i>x:\dir\dir2</i> with dangling symbolic links/junction, but this feature is useful if someone wants to migrate
                                a whole disk to another physical media.
                            </p>

                            <span class="ascode">
                                <br />ln --copy x:\ y:\
                                <br />unmount disk from x:\
                                <br />mount disk under y:\
                                <br />ln --smartrename y:\ x:\<br />
                                <br />unmount disk from y:\
                                <br />mount disk under x:\<br />
                            </span>

                            <p>
                                See also the note on <a href="#quotesaroundpath">quotes</a>
                            </p>
                            <br />
                        </td>
                    </tr>

                    <!-- Multiple Source -->
                    <tr>
                        <td class="hanger2">
                            <a name="multiplesource"><b>--source</b><br />Multiple Source</a>
                        </td>

                        <td align="left" class="bodytext">
                            <p>
                                Multpiple source locations can be specified for SmartCopy, Clone and Delorean Copy. If there are junctions/symlinks
                                between these source locations, they are handled as inner junctions/symlinks, because all source locations are dealt
                                with as a common root.
                            </p>
                            <br />
                            <img src="multiplesource.png" alt="Multiple Sources" />
                            <p>
                                In the above example <i>Location 1</i> and <i>Location 2</i> are copied to <i>Destination</i>.
                                <i>Location2/Junction_Symlink</i> is treated as inner junctions to <i>Location1/Folder 10</i> in the source,
                                and that's why <i>Destination/Junction_Symlink</i> points to <i>Destination/Folder 10</i> in the Destination.
                            </p>
                            <p>
                                The objective behind this is to treat all junctions/symlinks as inner junctions/symlinks as long as
                                they are in the set of source folders.
                            </p>

                            <br />
                            <p>
                                <b>Merging into one destination</b><br />
                                The command line invocation below copies from "c:\Location 1" and "c:\Location 2"
                                to c:\Destination :
                            </p>

                            <span class="ascode">
                                ln --source "c:\Location2" --copy "c:\Location1" "c:\Destination"
                            </span>
                            <p>
                                <br />
                                There can be more than one additional --source command-line switches:
                            </p>
                            <span class="ascode">
                                ln --source "c:\Location 2" --source "d:\Location 5" --copy "c:\Location 1" c:\Destination
                            </span>
                            <p>
                                <br />
                                Specifying additional source paths can be combined with --splice or --unroll:
                            </p>
                            <span class="ascode">
                                ln --unroll --source "c:\Location 2" --copy "c:\Location 1" c:\Destination
                            </span>
                            <p>
                                The above command copies all content from "c:\Location 2" and "c:\Location 1" to c:\Destination, but
                                does not create a "c:\Destination\Location 2" and a "c:\Destination\Location 1".
                            </p>
                            <br />
                            <p>
                                <a name="destinationusage"></a>
                                <b>Keeping several destinations</b><br />
                                To keep several destinations the --destination option must be used:
                            </p>
                            <span class="ascode">
                                ln --unroll --source "c:\Location 2" --destination "c:\Destination\Location 2" --copy "c:\Location 1" "c:\Destination\Location 1"
                            </span>
                            <p>
                                <br />
                                The --destination option must always be used with a corresponding --source option building pairs. The
                                order of --source --destination is also important. For --copy the normal destination builds the pair:
                            </p>
                            <span class="ascode">
                                ln --source SrcA --destination DstA --source SrcB --destination DstB --source SrcC --destination DstC --copy SrcD DstD
                            </span>
                            <br />
                            <br />
                            <p>
                                <b>Mirror to several destinations</b><br />
                                The --mirror option can also be used to mirror to several destinations
                            </p>
                            <span class="ascode">
                                ln --source "c:\Location 2" --destination "c:\Destination\Location 2" --mirror "c:\Location 1" "c:\Destination\Location 1"
                            </span>
                            <p>
                                Make sure that c:\Destination already exists
                            </p>
                            <br />
                            <br />
                            <br />
                            <br />
                        </td>
                    </tr>

                    <!-- supportfs -->
                    <tr>
                        <td class="hanger2">
                            <a name="supportfs"><b>--supportfs</b><br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                There are a lot of filesystems out by third party vendors nowadays, which support hardlinks, symlinks...
                                In order to provide the ln.exe functionality on that drives, the supported filesystems can be given:<br />
                            </p>

                            <span class="ascode">
                                ln --supportfs winbtrfs --copy source destination
                            </span>
                            <br />
                            <br />
                            <p>
                                Configuring your favourite filesystem to be recognized by ln.exe is on your own risk. Basically ln.exe would do all operations
                                to the configured filesystems, which it does to NTFS. So make sure your filesystem supports the same primitives as NTFS does,
                                otherwise certain operations will fail.
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- symbolic -->
                    <tr>
                        <td class="hanger2">
                            <a name="symboliclinks"><b>--symbolic<br /></b>Symbolic Links</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                When used under Vista or Windows7/8 ln.exe can create symbolic links
                            </p>

                            <span class="ascode">
                                ln --symbolic Sourcefile.txt SymbolicLinkToSourceFile.txt
                            </span>
                            <p>
                                In the above example a symbolic link <i>SymbolicLinkToSourceFile.txt</i>
                                is created which points to <i>sourcefile.txt</i>.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --symbolic Sourcefile.txt DestinationDirectory
                            </span>
                            <p>
                                In the above example a symbolic link <i>DestinationDirectory\Sourcefile.txt</i>
                                is created which points to <i>Sourcefile.txt</i>.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --symbolic SourceDirectory SymbolicLinkToSourceDirectory
                            </span>
                            <p>
                                In the above example a symbolic link <i>SymbolicLinkToSourceDirectory</i>
                                is created which points to <i>SourceDirectory</i>.
                            </p>
                            <br />

                            <span class="ascode">
                                ln --symbolic SourceDirectory DestinationDirectory\
                            </span>
                            <p>
                                In the above example a symbolic link <i>DestinationDirectory\SourceDirectory</i>
                                is created which points to <i>SourceDirectory</i>.
                                A traling backslash is the trigger for this to work.
                            </p>
                            <br />

                            <br />

                            <p>
                                ln.exe can also only show the target of a symbolic link
                            </p>

                            <span class="ascode">
                                ln --symbolic SymbolicLinkToSourceFile.txt
                            </span>
                            <br />

                            <p>
                                ln.exe can also symbolically link to volume-guid targets:
                            </p>
                            <a name="symbolicvolumeguid"></a>
                            <span class="ascode">
                                ln --symbolic \\?\Volume{f6c8b244-1ce4-11e0-a607-005056c00008}\tmp SymbolicLinkName
                            </span>
                            <br />
                            <p>
                                In the above example the symbolic link <i>SymbolicLinkName</i> is created to a volume-guid target.
                                This is useful if you are either out of drive letters, or just want to have a link to a directory on a
                                mounted drive regardless with of which drive-letter it is mounted on. To find out the available volume-guids
                                use the mountvol.exe command.
                            </p>
                            <br />

                            <b>
                                Please note that symbolic links can only be successfully created from an administrative command prompt.
                                ln.exe will fail on symbolic links from a normal command prompt!
                            </b>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>


                    <!-- timetolerance-->
                    <tr>
                        <td class="hanger2">
                            <a name="timetolerance"><b>--timetolerance</b><br /></a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                During --mirror and --delorean it is sometimes useful to not have an exact timestamp comparison between
                                source and destination, but kind of a fuzzy comparison, because the systemtime of NAS drives is not exactly synced
                                with the host.
                            </p>
                            <p>
                                To overcome this ln.exe has a --timetolerance switch to specify a value in milliseconds
                            </p>
                            <span class="ascode">
                                ln --timetolerance 2000 --mirror source destination
                            </span>
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- traditional-->
                    <tr>
                        <td class="hanger2">
                            <a name="traditional"><b>--traditional</b><br />Traditional<br />mode</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                Some NAS boxes only support a very outdated version of the SMB protocol. SMB is
                                used when network drives are connected. This old version of SMB in certain situations does not support the
                                fast enumeration methods of ln.exe, which causes ln.exe to simply do nothing in SmartXXX functions.
                            </p>
                            <p>
                                To overcome this ln.exe has a --traditional switch, which forces ln.exe to enumerate files the old, but a
                                little slower way.
                            </p>
                            <span class="ascode">
                                ln --traditional --copy source destination ...
                            </span>
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <!-- truesize-->
                    <tr>
                        <td class="hanger2">
                            <a name="truesize"><b>--truesize</b><br />Size<br />calculation</a>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                Prints the true space used taking into account hardlinks. This means that a file with a size of e.g 12345kb and
                                a reference count 5, will be listed with 61725kb by explorer, but indeed it only uses 12345kb, because it has a
                                refcount of 5.
                            </p>
                            <span class="ascode">
                                ln --truesize path
                            </span>
                            <p>
                                returns the following output
                            </p>

                            <table class="outputtable">
                                <tr>
                                    <td align="right" width="120">
                                        &nbsp;
                                    </td>
                                    <td align="right" width="160">
                                        Items
                                    </td>
                                    <td align="right" width="160">
                                        Bytes
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        File:
                                    </td>
                                    <td align="right" width="160">
                                        14.012
                                    </td>
                                    <td align="right" width="160">
                                        6.871.558.902
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        Hardlink:
                                    </td>
                                    <td align="right" width="160">
                                        5
                                    </td>
                                    <td align="right" width="160">
                                        133.991
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        Total:
                                    </td>
                                    <td align="right" width="160">
                                        -
                                    </td>
                                    <td align="right" width="160">
                                        6.871.424.911
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        Folder:
                                    </td>
                                    <td align="right" width="160">
                                        2.294
                                    </td>
                                    <td align="right" width="160">
                                        -
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        Junction:
                                    </td>
                                    <td align="right" width="160">
                                        0
                                    </td>
                                    <td align="right" width="160">
                                        -
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        Symlink:
                                    </td>
                                    <td align="right" width="160">
                                        1
                                    </td>
                                    <td align="right" width="160">
                                        -
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="7">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        &nbsp;
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        Overall
                                    </td>
                                </tr>
                                <tr>
                                    <td align="right" width="120">
                                        Times:
                                    </td>
                                    <td align="right" width="160" colspan="2">
                                        00:00:06.171
                                    </td>
                                </tr>
                            </table>

                            <p>
                                The --truesize option does not return info on alternate data streams right now.
                            </p>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>


                    <!-- 1023safe -->
                    <tr>
                        <td class="hanger2">
                            <a name="1023safe"><b>--1023safe</b><br />Hardlink Limit Safe</a>
                        </td>

                        <td align="left" class="bodytext">
                            <p>
                                NTFS puts a 1023 limit on the number of hardlinks a file can have. In most cases this is not a problem,
                                but if many delorean copies are stored, and files are hardlinked within a delorean copy too, it might
                                turn out that the limit of 1023 hardlinks is reached and the error ERROR_TOO_MANY_LINKS is thrown.
                                <br />
                                <br />
                                To overcome this either the number of stored backups can be reduced by applying the
                                <a href="#towerofhanoi">Tower of Hanoi</a> backup strategy, or by using the <i>1023safe option</i>
                                <br />
                                <br />
                                The <i>1023safe option</i> can not lift NTFS limits, but for a little performance penalty it can check if the limit is exceeded
                                and if neccessary introduce a copy in the chain of hardlinks, and then hardlink the files to this newly introduced copy:
                            </p>
                            <br />
                            <img src="1023limit.png" alt="1023 Hardlink Limit" />
                            <p>
                                In the above example a setup is shown, which has already applied three iterations of <a href="#deloreancopy">delorean copy</a>:<br />
                                <ul>
                                    <li>
                                        Intitially there was a directory which contained the file B, and the hardlinks A001 to A500. So the reference count
                                        was 1 for file B, and 500 for A001 to A500. So far so good.
                                    </li>
                                    <li>
                                        The first Delorean Copy copied over from Backup0 to Backup1, which increased the reference count for file B to 2, and
                                        A001 to A500 were pushed to a reference count of 1000. Still ok.
                                    </li>
                                    <li>
                                        With the third Delorean Copy the reference count for file B goes to 3 and for A001 to A500 it would have been
                                        increased to 1500. This would be a violation of the <a href="#errortoomanylinks">1023 limit</a>!
                                        Without the <i>--1023safe</i> option, this delorean copy would <a href="#deloreanfailed1023">fail</a>.
                                        <br />
                                        <br />
                                        With the <i>--1023safe option</i> ln.exe checks if the limit would have been reached, and if neccessary introduces a copy of A001
                                        in Backup2 instead of hardlinks for A001, and links A002 to A500 to the newly created copy. This reduces the refcount for
                                        A001 ... A500 again to 500, and the game can go on.
                                    </li>
                                </ul>
                                So why not using the <i>1023safe option</i> by default: There is a little performance penalty, because for the enumeration on the
                                items to be cloned from one backup to the other, ln.exe has to switch back the to the <a href="#traditional">traditional mode</a>,
                                which is slightly slower.
                                <br />
                                <br />
                                <br />
                            </p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>


        <!-- Unc Name Support-->
        <tr>
            <td class="hanger">
                <a name="uncnamesupport"><b>UNC Name<br /> support</b></a>
            </td>
            <td align="left" class="bodytext">
                <p>
                    A local path can be a UNC name, which maybe reached from outside the computer via a share.
                    Sometimes it is necessary to use UNC names to refer to local paths.<br />
                    ln resolves local UNC names to local path names and does its job on those resolved path names. e.g.:
                </p>
                <br />
                <span class="ascode">
                    ln \\local_computer\local_share\sourcefile.txt x:\dir_on_local_computer\destination.txt
                </span>

                <p>
                    In the above example there is a share called <i>local_share</i> on your
                    <i>local_computer</i> which contains a file <i>sourcefile.txt</i>. ln resolves the
                    UNC name to a local path if possible, and creates a link between the resolved location
                    and <i>destination.txt</i> in <i>x:\dir_on_local_computer</i>.
                </p>
                <br />
                <span class="ascode">
                    ln --copy \\server\share\source \\server\share\destination
                </span>

                <p>
                    In the above example there is a share called <i>share</i> on your
                    <i>server</i> which contains a directory <i>source</i>. ln.exe copies over the content
                    from the source UNC path to the destination UNC path and preserves hardlink structures.
                </p>
                <br />

                <span class="ascode">
                    ln --delorean \\server\share\source \\server\share\destination \\server\share\backup
                </span>

                <p>
                    UNC Path are also supported for --delorean and preserves hardlink structures.
                </p>
                <br />

                <span class="ascode">
                    ln --recursive \\server\share\source \\server\share\destination
                </span>

                <p>
                    UNC Path are also supported for --recursive so that hardlink clones are created.
                </p>
                <br />
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>


        <!-- Quotes-->
        <tr>
            <td class="hanger">
                <a name="quotesaroundpath"><b>Quotes<br />around path</b> </a>
            </td>
            <td align="left" class="bodytext">
                <p>
                    If there are blanks in the argument path to ln.exe, the pathname has to be put inside quotes, e.g.
                </p>
                <span class="ascode">
                    ln --copy "x:\dir with blanks\dir2" "y:\destination with blanks\newdir"
                </span>
                <p>
                    Please make sure not to end a quoted path with \ because ln.exe treats this as escaping of the
                    quote (\") and can not parse the command line.
                </p>
                <span class="ascode">
                    <s>
                        ln --copy "x:\" y:\dir\newdir
                    </s>
                </span>
                <br />
            </td>
        </tr>

        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>

        <!-- Subst Handling -->
        <tr>
            <td class="hanger">
                <a name="substhandling">Subst Handling</a>
            </td>
            <td class="bodytext">
                <p>
                    With the subst.exe command one can create driveletters, which point to a certain path on a NTFS volume. This means that two
                    different driveletters in the end might resolve to locations on the same NTFS volume.
                </p>
                <p>
                    ln.exe checks these situations when it comes to allow the creation of hardlinks, and as a consequence allows
                    the creation of hardlinks among different logical drives if they resolve to the same NTFS volume.
                </p>
                <br />
            </td>
        </tr>

        <!-- Snapshot Service -->
        <tr>
            <td class="hanger">
                <a name="snapshotservice">Snapshot Service</a>
            </td>
            <td class="bodytext">
                <p>
                    Shadow Copy (Volume Snapshot Service or Volume Shadow Copy Service or VSS), is a technology included
                    in Microsoft Windows that allows taking manual or automatic backup copies or snapshots of data, even if
                    it has a lock, on a specific volume at a specific point in time over regular intervals.
                </p>
                <p>
                    There are two ways to achieve this:
                </p>
                <p>
                    <b>The way with a drive-letter</b>
                </p>
                <p>
                    ln.exe can be used to create consistent copies from a snapshot: 4 files are needed:
                    vshadow.exe, ln.exe, dosdev.exe, vss-exec.cmd. Place the files where you want, but
                    vshadow.exe and dosdev.exe need to be in the path.
                </p>

                <p>
                    A backup of an entire e.g. E:\ or parts from it can be accomplished with this command:
                </p>
                <p>
                    <span class="ascode">
                        vshadow.exe -script=vss-setvar.cmd -exec=vss-exec.cmd e:
                    </span>
                </p>

                <p>
                    The <i>-script=vss-setvar.cmd</i> is a command line argument to vshadow.exe that gives the shadow copy
                    an identifier string so that a drive letter can be assigned to it - which allows ln.exe to access the
                    files.
                </p>

                <p>
                    The <i>-script=vss-exec.cmd</i> is a command line argument to vshadow.exe that contains the name
                    of a file, which is executed within vshadow.exe and does the very backup job:
                </p>

                <span class="ascode">
                    <br />REM
                    <br />REM called from vshadow via commandline e.g
                    <br />REM
                    <br />REM    vshadow.exe -script=vss-setvar.cmd -exec=vss-exec.cmd e:
                    <br />REM
                    <br />
                    <br />REM vss-setvar.cmd is generated by vshadow.exe
                    <br />REM
                    <br />call vss-setvar.cmd
                    <br />
                    <br />REM assign a DOS device to the created snapshot
                    <br />REM
                    <br />dosdev x: %shadow_device_1%
                    <br />
                    <br />REM run the intended copy job
                    <br />REM
                    <br />set LN=c:\tools\ln.exe
                    <br />%LN% --copy x:\path e:\backup
                    <br />
                    <br />REM finally remove the drive letter
                    <br />REM
                    <br />dosdev -r -d x:
                </span>

                <p>
                    The event process is this:
                </p>
                <p>
                    The vshadow.exe program creates a shadow copy, and then calls the on the fly generated <i>vss-setvar.cmd</i>
                    that assigns a variable to the shadow copy. Then the given batch file
                    <a href="bat/vss-exec.cmd"><i>vss-exec.cmd</i></a> is executed within
                    vshadow.exe. Dosdev.exe first assigns the drive letter x: to the shadow copy. ln.exe can be called now with whatever
                    parameters are necessary at this time. By the end dosdev.exe removes the drive letter and
                    vshadow.exe is allowed to exit.
                </p>
                <br />

                <p>
                    The vshadow.exe generates an e.g <i>vss-setvar.cmd</i>:
                    <br />
                    <span class="ascode">
                        <br />@echo.
                        <br />@echo [This script is generated by VSHADOW.EXE for the shadow set {95a6cd9f-bc45-43b8-8722-6c25ec06fe94}]
                        <br />@echo.
                        <br />
                        <br />SET SHADOW_SET_ID={95a6cd9f-bc45-43b8-8722-6c25ec06fe94}
                        <br />SET SHADOW_ID_1={e38169c1-6aa7-4843-ac50-4c7b652397b3}
                        <br />SET SHADOW_DEVICE_1=\\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1
                    </span>
                </p>

                <br />
                <p>
                    There are different versions of vshadow.exe (32bit, 64bit, workstation, and server).
                    You can download them from <a href="bat/vshadow.zip">here</a> in the same way as
                    for <a href="bat/dosdev.exe">dosdev</a>
                </p>

                <br />
                <br />

                <b><a name="vss_unc.cmd">The way with an UNC share</a></b>
                <p>
                    If for some reason no drive letter is available, a similar strategy as above can be applied via an UNC share:
                </p>
                <span class="ascode">
                    <br />REM
                    <br />REM General settings, please adjust to your needs!
                    <br />REM
                    <br />set SRC_DRIVE=e:
                    <br />set SRC_PATH=tmp\src
                    <br />set DST_PATH=x:\bla\foo
                    <br />
                    <br />set VSHADOW=vshadow.exe
                    <br />set LN=ln.exe
                    <br />
                    <br />REM Create a temporary name for the share, e.g. take the timestamp
                    <br />REM
                    <br />for /f "delims=" %%a in ('%LN% --datetime') do set VSS_SHARE=%%a
                    <br />
                    <br />REM call vshadow to create a persistent shadow
                    <br />REM
                    <br />%VSHADOW% -p -script=vss-setvar.cmd %SRC_DRIVE%
                    <br />
                    <br />REM vss-setvar.cmd has been generated by vshadow.exe
                    <br />REM
                    <br />call vss-setvar.cmd
                    <br />
                    <br />REM Create the temporary share, and specify a path relative to %SRC_DRIVE
                    <br />REM via %SRC_PATH%. %VSS_SHARE% will then point to %SRC_DRIVE\%SRC_PATH%
                    <br />REM
                    <br />%VSHADOW% -er=%shadow_id_1%,"%VSS_SHARE%","%SRC_PATH%"
                    <br />
                    <br />REM Run the intended copy job
                    <br />REM
                    <br />%LN% --copy \\localhost\%VSS_SHARE% %DST_PATH%
                    <br />
                    <br />REM Remove the share
                    <br />REM
                    <br />%VSHADOW% -ds=%SHADOW_ID_1%
                </span>

                <p>
                    The <a href="bat/vss_unc.cmd">vss_unc.cmd</a> script can be found here.
                </p>
                <p>
                    The vss_unc.cmd must be adapted with the proper SRC_DRIVE, SRC_PATH, DST_PATH in line 3 to 6 and issuing
                </p>
                <span class="ascode">
                    <br />&nbsp; vss_unc.cmd
                </span>
                <p>
                    will do the job.
                </p>
                <br />
                <br />


                <b><a name="vss_raw.cmd">The Raw Way</a></b>
                <p>
                    Directly accessing snapshots from <a href="#volumeguidsupport">Windows namespace</a> is also possible
                    and the most cleanest and meanest way:
                </p>
                <span class="ascode">
                    <br />REM
                    <br />REM General settings, please adjust to your needs!
                    <br />REM
                    <br />set SRC_DRIVE=e:
                    <br />set SRC_PATH=tmp\src
                    <br />set DST_PATH=x:\bla\foo
                    <br />
                    <br />set VSHADOW=vshadow.exe
                    <br />set LN=ln.exe
                    <br />
                    <br />REM call vshadow to create a persistent shadow
                    <br />REM
                    <br />%VSHADOW% -p -script=vss-setvar.cmd %SRC_DRIVE%
                    <br />
                    <br />REM vss-setvar.cmd has been generated by vshadow.exe
                    <br />REM
                    <br />call vss-setvar.cmd
                    <br />
                    <br />REM Run the intended copy job
                    <br />REM
                    <br />%LN% --copy %SHADOW_DEVICE_1%\%SRC_PATH% %DST_PATH%
                    <br />
                    <br />REM Remove the shadow
                    <br />REM
                    <br />%VSHADOW% -ds=%SHADOW_ID_1%
                </span>

                <p>
                    The <a href="bat/vss_raw.cmd">vss_raw.cmd</a> script can be found here.
                </p>
                <p>
                    The vss_raw.cmd must be adapted with the proper SRC_DRIVE, SRC_PATH, DST_PATH in line 3 to 6 and issuing
                </p>
                <span class="ascode">
                    <br />&nbsp; vss_raw.cmd
                </span>
                <p>
                    will do the job.
                </p>


                Please also see <a href="#anchor">the anchor option</a>, which enables ln.exe to also copy junctions and absolute
                symbolic links properly when within snapshots, either mapped as drives or UNC path.
                <br />
                <br />
                <br />

                <b><a name="vss_drivecopy.cmd">Copying a full drive via snapshots</a></b>
                <br />
                <span class="ascode">
                    <br />REM
                    <br />REM General settings, please adjust to your needs!
                    <br />REM
                    <br />set SRC_DRIVE=e:
                    <br />set DST_PATH=x:\bla\foo
                    <br />
                    <br />set VSHADOW=vshadow.exe
                    <br />set LN=ln.exe
                    <br />
                    <br />REM call vshadow to create a persistent shadow
                    <br />REM
                    <br />%VSHADOW% -p -script=vss-setvar.cmd %SRC_DRIVE%
                    <br />
                    <br />REM vss-setvar.cmd has been generated by vshadow.exe
                    <br />REM
                    <br />call vss-setvar.cmd
                    <br />
                    <br />REM Run the intended copy job
                    <br />REM
                    <br />%LN% --backup --anchor %SRC_DRIVE%\ --mirror %SHADOW_DEVICE_1% %DST_PATH%
                    <br />
                    <br />REM Remove the shadow
                    <br />REM
                    <br />%VSHADOW% -ds=%SHADOW_ID_1%
                </span>

                <p>
                    The <a href="bat/vss_drivecopy.cmd">vss_drivecopy.cmd</a> script can be found here.
                </p>
                <p>
                    The vss_drivecopy.cmd must be adapted with the proper SRC_DRIVE, DST_PATH in line 3 to 5 and issuing
                </p>
                <span class="ascode">
                    <br />&nbsp; vss_drivecopy.cmd
                </span>
                <p>
                    will do the job.<br /><br />
                    Ln.exe will mirror the content from %SHADOW_DEVICE_1% to %DST_PATH%, but it is important to note that the --anchor %SRC_DRIVE%\ will let all
                    inner junctions / symbolic links from %SHADOW_DEVICE_1% be also inner junctions / symbolic links in %DST_PATH%. <br /><br />
                    If this would be omitted all inner junctions / symbolic links from %SHADOW_DEVICE_1% would be outer junctions / symbolic links and depending on the
                    option would be cropped, spliced or unrolled.<br /><br />
                    Please check the <a href="#anchor">the anchor option</a> and the <a href="#destination">destination option</a> for a indepth explanation.
                </p>


                <br />
                <br />
            </td>
        </tr>

        <!-- Deep Path Support -->
        <tr>
            <td class="hanger">
                <a name="deeppathsupport">Deep Path Support</a>
            </td>
            <td class="bodytext">
                <p>
                    ln.exe can handle <i>Deep Paths</i> which are longer than 256 characters. This is usefully especially in
                    the --copy, -delorean, --move, --mirror, --recursive mode. Deep Path Support is tested
                    for the whole ln.exe functionality.
                </p>
                <br />
            </td>
        </tr>

        <!-- Support for Volume{GUID} Path -->
        <tr>
            <td class="hanger">
                <a name="volumeguidsupport">Support for<br />Volume{GUID} Path<br />and GLOBALROOT</a>
            </td>
            <td class="bodytext">
                <p>
                    All --copy, -delorean, --move, --mirror, --recursive commands can handle \\?\Volume{GUID} or
                    \\?GLOBALROOT\Device\HarddiskVolume as path for operations:
                </p>
                <br />

                <span class="ascode">
                    ln --copy SrcDir \\?\Volume{97410ad7-54ec-11e3-97ab-005056c00008}\
                </span>

                <br />
                <br />
                <span class="ascode">
                    ln --copy SrcDir \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy\
                </span>
                <br />

                <p>
                    The above example copies files onto a formatted disk which is not mounted. To find out which volumes are
                    available in the system use mountvol.exe from a command prompt. Please make sure that the root of a volume has
                    a trailing slash, e.g. \\?\Volume{GUID}<b>\</b>, but a normal path specified has not, e.g.: \\?\Volume{GUID}\MyPath\dir
                    <br />
                    <br />
                    Accessing like this is useful when providing volumes for <a href="#vss_raw.cmd">snapshots</a>.
                </p>
                <br />
            </td>
        </tr>

        <!-- Symbolic links for Windows XP -->
        <tr>
            <td class="hanger">
                <a name="symboliclinksforwindowsxp">Symbolic links for Windows XP</a>
            </td>
            <td class="bodytext">
                <p>
                    Technically it seems that NTFS5 even as shipped with WindowsXP has always supported symbolic links, but the functionality was
                    not available for user mode applications, and even not for the upper layers of ntfs.sys
                </p>
                <p>
                    <b>BUT:</b> There are filter drivers available from Masatoshi Kimura for WindowsXP, which enable symbolic links
                    under XP. These drivers can be downloaded from his home page for <a href="https://emk.name/symlink-1.06-x64.zip">64 bit</a> and for
                    <a href="https://emk.name/symlink-1.06-x86.cab">32 bit</a>. The <a href="https://emk.name/symlink-1.06-src.zip">
                        sources
                    </a> are also available.
                </p>

                Installation of these drivers is also quite simple.
                <ul>
                    <li>Unpack the archive for your plattform, </li>
                    <li>Start the driver via executing 'senable.exe install' from the command prompt.</li>
                </ul>
                <p>
                    If you want to stop the driver, execute from a command prompt 'senable.exe delete'
                </p>

                <p>
                    ln.exe enables its symbolic link functions even when running WindowsXP, if it finds this driver installed.
                </p>
                But unfortunatley this driver has a few limitations, which in 99% of the use cases are not a problem, but for completeness:
                <ul>
                    <li>
                        Symbolic links, which have been created with the symbolic link driver installed, can not be copied/used wihtout
                        the symbolic link driver.
                    </li>
                    <li>
                        Symbolic links can be created on mapped network drives or UNC pathes, but such a symbolic link can't be <a href="#symlink_fail_01">resolved aka followed</a>.
                    </li>
                </ul>
                <br />
            </td>
        </tr>

        <!-- Useful .bat files -->
        <tr>
            <td class="hanger">
                <a name="batfiles">
                    Useful .bat and <br />
                    powershell scripts
                </a>
            </td>
            <td class="bodytext">
                <p>
                    ln.exe can be used also from .bat or powershell scripts to accomplish various tasks:
                </p>
                <p>
                    <a name="towerofhanoi"></a>
                    <b><a href="bat/DeLoreanHanoi.bat">Tower of Hanoi</a></b> backup rotation scheme using Delorean Copies.<br />
                    Creates a number of backups using the
                    <a href="https://en.wikipedia.org/wiki/Backup_rotation_scheme#Tower_of_Hanoi">Tower of Hanoi backup rotation scheme </a><br />
                    &nbsp; Usage: DeloreanHanoi.bat SourceDir BackupDir [BackupSets]
                </p>
                <p>
                    <a name="deloreanbat"></a>
                    <b><a href="bat/DeLoreanCopy.bat">Create timestamped DeLorean Copies</a></b> as
                    <a href="https://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html#deloreancopy">Link Shellextension</a>
                    does: 'data - yyyy-mm-dd hh-mm-ss', e.g 'MyData 2010-09-11 17-04-03'. Furthermore the number of backup-sets to be kept can be specified via the optional <i>KeepEntries</i> argument.<br />
                    &nbsp; Usage: DeloreanCopy.bat SourceDir BackupDir [KeepEntries]
                </p>
                <p>
                    <a name="deloreanpowershell"></a>
                    <b><a href="https://mahala.de/Windows/HardlinkBackup/">Create incremental backups from Powershell.</a></b> Andreas Marktscheffel wrote some nice scripts<br />
                    using ln.exe from Powershell to create incremental backups. Check his <a href="https://mahala.de/Windows/HardlinkBackup/">page.</a>
                </p>
                <p>
                    <b><a href="bat/DeleteAllHardlinks.bat">Delete all hardlink siblings</a></b>. This
                    .bat file uses the --list option to enumerate all hardlinks and successively deletes
                    them.<br />
                    &nbsp; Usage: DeleteAllHardlinks.bat Filename<br />
                </p>


                <p>
                    <b><a href="bat/QueryPath.cmd">Determines whether a path is a junction, symlink or directory</a></b>
                    and prints this on the command prompt. Courtesy of archimede0 at bluewin.ch
                    .<br />
                    &nbsp; Usage: QueryPath.cmd Path<br />
                </p>

                <br />
            </td>
        </tr>

        <!-- Return Values -->
        <tr>
            <td class="hanger">
                <a name="returnvalues">Return Values</a>
            </td>
            <td class="bodytext">
                <p>
                    As a typical command line utility ln.exe exits with return values, so that it can be conveniently used from .bat files:
                </p>
            </td>
        </tr>

        <tr>
            <td align="right" valign="top">
                &nbsp;
            </td>
            <td class="bodytext">
                <table cellspacing="0" cellpadding="0" border="0">
                    <tr>
                        <td class="bodytext">
                            0
                        </td>
                        <td align="left" class="bodytext">
                            Success. Everything is fine.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="bodytext">
                            -1
                        </td>
                        <td align="left" class="bodytext">
                            The source directory given via command line parameters does not exist.<br />
                            This happens in recursive mode if the first command line argument is not there
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -2
                        </td>
                        <td align="left" class="bodytext">
                            The first command line argument in recursive mode specifies a directory, and it is not a directory,
                            but some other kind of file.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -3
                        </td>
                        <td align="left" class="bodytext">
                            The second command line argument specifies a file, or in recursive mode a directory, which already exists.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -4
                        </td>
                        <td align="left" class="bodytext">
                            The destination directory could not be created in recursive mode.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -5
                        </td>
                        <td align="left" class="bodytext">
                            The source file aka first command line parameter does not exist in normal mode.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -6
                        </td>
                        <td align="left" class="bodytext">
                            The filesystem is not NTFS and does not support the creation of hardlinks.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -7
                        </td>
                        <td align="left" class="bodytext">
                            For some unknown reason the creation of a hardlink failed.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -8
                        </td>
                        <td align="left" class="bodytext">
                            Less arguments were given via command line.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -9
                        </td>
                        <td align="left" class="bodytext">
                            Ln was not able to enumerate the files in a directory. This might happen in recursive or in hardlink
                            enumeration mode if the file permissions for a directory are insufficient.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -10&nbsp;&nbsp;
                        </td>
                        <td align="left" class="bodytext">
                            Too many hardlinks. The 1023 limit was exceeded
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -11
                        </td>
                        <td align="left" class="bodytext">
                            Not on same volume. Happens if you try to hardlink accross columes
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -12
                        </td>
                        <td align="left" class="bodytext">
                            Ln.exe was not able to create a SmartCopy.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -13
                        </td>
                        <td align="left" class="bodytext">
                            No hardlink groups have been found.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -14
                        </td>
                        <td align="left" class="bodytext">
                            Ln.exe was not able to create a clone.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -15
                        </td>
                        <td align="left" class="bodytext">
                            Ln.exe failed in --mirror.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -16
                        </td>
                        <td align="left" class="bodytext">
                            Ln.exe failed in --delorean.
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -17
                        </td>
                        <td align="left" class="bodytext">
                            Access denied
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -18
                        </td>
                        <td align="left" class="bodytext">
                            Operation not supported
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -19
                        </td>
                        <td align="left" class="bodytext">
                            Smartdelete failed
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="bodytext">
                            -20
                        </td>
                        <td align="left" class="bodytext">
                            Target directory does not exist
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <br />
                        </td>
                    </tr>

                </table>
            </td>
        </tr>

        <!-- Backgrounders -->
        <tr>
            <td class="hanger">
                <a name="backgrounders">Backgrounders</a>
            </td>
            <td class="bodytext">
                <p>
                    Hardlinks are a feature which are common to every
                    Unix system, but are not directly available with NT4/W2K/WXP. It is a feature, which
                    must be basically supported by the file system of the operating system.
                </p>
                <p>
                    So what are hardlinks in detail. It is common knowledge,
                    that a file has a name and data associated to it. By opening the explorer, the NTFS
                    filesystem of NT4/W2K/WXP can be browsed comfortably. There is a 1:1 relationship
                    between the <i>filename</i> and the <i>filedata</i>, but this assumption does not
                    hold for every filesystem.
                </p>
                <p>
                    Some filesystems, such as UFS, XFS, or NTFS have a N:1 relationship between <i>filename</i> and
                    the <i>filedata</i>. So this means there is more than one directory entry for a file.
                </p>
                <p>
                    But how does one create those multiple entries? There is a command under Unix called <i>ln</i>, which
                    creates many file entries for a file, so that there are many filenames or also called hardlinks for one filedata.
                </p>
                <p>
                    For each hardlink created, the filesystem increments a reference count stored with the <i>filedata</i>, so
                    that the <i>filedata</i> stores how many filenames point to it. If a filename pointing to a hardlinked
                    filedata gets deleted, the reference count stored with the filedata gets decremented by one. The filedata
                    gets deleted when the reference count of the filedata decreases to zero.
                </p>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>

        <!-- Limitations -->
        <tr>
            <td class="hanger">
                <a name="limitations">Limitations</a>
            </td>
            <td class="bodytext">
                <p>
                    Ln.exe can only be used under the supported platforms<br />
                    HardLinks can only be created on NTFS volumes, under the supported platforms.<br />
                    HardLinks can only be created within one NTFS volumes, and can not span across
                    NTFS volumes.<br />
                </p>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>


        <!-- Frequently Asked Questions -->
        <tr>
            <td class="hanger">
                <a name="faq">Frequently Asked Questions</a>
            </td>

            <td class="bodytext">
                <ul>
                    <li>
                        <b>
                            <a name="faq01">Q</a>: I'm trying to use ln for a selective backup of the "Users" folder, and I'm having
                            trouble with the --includedir option, because nothing gets copied:<br /><br />
                        </b>
                        <span class="ascode">ln --includedir "*\\My Documents" --copy C:\Users X:\pc01-office\Users</span>
                        <br />

                        <p>
                            A: The point is that explorer.exe fools you into believing, that directories like 'My Documents' exist,
                            but they do not exist. Open a command prompt, change to c:\users and type 'dir'.<br />
                            The files and directories you see now are very much different, than you can see in explorer. <br /><br />

                            So far so bad. ln.exe unfortunately only sees what the filesystem really has, and this is not e.g 'My Documents'.
                            If you put a --includedir filter for '*My Documents*' it will not work, because in the NTFS namespace 'My Documents' is not there.
                        </p>
                    </li>

                    <li>
                        <b>
                            <a name="faq02">Q</a>: I only changed the attributes of a file, even the timestamp and content are the same, but --delorean copies the
                            file instead of linking to the old backupsets and just changing the attributes in the current backup set.
                        </b>
                        <br /><br />

                        <p>
                            A: The files in the backup sets of --delorean are hardlinked if they are the same. NTFS provides <i>one set</i> of timestamps and
                            attributes for <i>all</i> hardlink-siblings of a file, so if a file needs different attributes in a backup, it has to be copied.
                            <br /><br />
                        </p>
                    </li>

                    <li>
                        <b>
                            <a name="faq03">Q</a>: With ln.exe running under PowerShell the redirected output displays garbled characters for vd| :
                        </b>
                        <br /><br />

                        <p>
                            A: Use the -enc OEM modifier when redirecting output as below in PowerShell:<br />
                            <br />
                            <span class="ascode">
                                ln.exe --copy src dest | out-file logfile.txt -enc OEM <br />
                            </span>

                            <br /><br />
                        </p>
                    </li>

                    <li>
                        <b>
                            <a name="faq04">Q</a>:
                            I wanted to recover a damaged (but still readable !!) NTFS volume whereas CHKDSK was unable to repair it, so I decided to
                            use ln.exe for copying the whole disk to a newly formatted volume. This worked well, the volume has been able to boot,
                            but the junctions were lost. Why?
                        </b>
                        <br /><br />

                        <p>
                            A: Junctions contain absolute path to refer their target. ln.exe tries to restore junctions relations in the
                            destination during copy by comparing the path where the junction resides in the source and the path
                            where the junctions in the source points to. If it is a <a href="#innerjunction">inner junction</a>,
                            it gets restored in the destination, else cropped.
                            <br />
                            <br />

                            So if you recover a disk, you
                            <ul>
                                <li>
                                    either mounted it to its original drive letter, because the junctions
                                    on this disk still refer to locations where it was originally mounted. ln.exe assumes now that this is
                                    an outer junction, and thus crops the junctions.
                                </li>
                                <li>
                                    or go the way with the <a href="#anchor">option.</a>
                                </li>

                            </ul>
                            <br />
                            <br />
                            The same happens if a drive was mapped as a <a href="#snapshotservice">snapshot</a>, and is available under anything else
                            than its original location. E.g. a drive c:\ mapped as \\localhost\vss_share via a snapshot will also loose junction relations
                            during e.g. copy: ln.exe --copy \\localhost\vss_share\source x:\dest, or use the <a href="#anchor">option.</a>
                            <br /><br />
                        </p>
                    </li>

                    <li>
                        <b>
                            <a name="faq05">Q</a>:
                            On Windows Server 2012 I get messages about <a href="#invalidreparse">invalid reparse points.</a> Why?
                        </b>
                        <br /><br />

                        <p>
                            A: Windows Server 2012 has a
                            <a href="https://blogs.technet.com/b/filecab/archive/2012/05/21/introduction-to-data-deduplication-in-windows-server-2012.aspx">
                                deduping feature
                            </a>, which is implemented via an undocumented Reparse Point. ln.exe can not handle copying this
                            reparse point, but adding the <a href="#unroll">--unroll</a> option to the command line will copy the files referenced by
                            the reparse point.
                            <br />
                        </p>
                    </li>

                </ul>
            </td>
        </tr>

        <!-- History -->
        <tr>
            <td class="hanger">
                <a name="history">History</a>
            </td>
            <td class="bodytext">
                <table cellspacing="0" cellpadding="0" border="0">

                    <tr>
                        <td class="hanger2">
                            November 26, 2022
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2930">Version 2.9.3.4</a>
                            <ul>
                                <!-- 2.9.3.5, 27.11.2022 -->
                                <li>ln.exe now maintains its <a href="#winget">winget package</a>.</li>
                                <!-- 2.9.3.4, 22.10.2022 -->
                                <li>Docu update on <a href="#anchor">--anchor</a> and <a href="#destination">--destination</a></a></li>
                                <!-- 2.9.3.4, 7.8.2021 -->
                                <li>--probefs failed on unknown filesystems</li>
                                <!-- 2.9.3.4, 28.2.2021 -->
                                <li>ln reports error code when it fails creating hardlinks</li>
                                <!-- 2.9.3.3, 9.2.2021 -->
                                <li>Introduced a static version of ln.exe for use under e.g. WinPE</li>
                                <li>Changed the behavior related to cirularties. No error message raised, but circularity are broken properly.</li>
                                <!-- 2.9.3.2, 28.1.2021 -->
                                <li>Multisource aka <a href="#destination">--destination</a> in combination with --mirror did not work.</li>
                                <!-- 2.9.3.1, 14.1.2021 -->
                                <li>Symbolic Link creation required admin even in developer mode.</li>
                                <!-- 2.9.3.0, 4.1.2021 -->
                                <li>Directories can be specified as destination with <a href="#symboliclinks">normal file or symbolic linking.</a></li>
                            </ul>
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            March 31, 2020
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2900">Version 2.9.2.8</a>
                            <ul>
                                <!-- 2.9.2.8, 31.3.2020 -->
                                <li>Fixed a race condition, when ln was called without --progress. Introduced in 2.9.2.6</li>
                                <!-- 2.9.2.6, 22.3.2020 -->
                                <li><a href="#progress">--progress</a> also shows <i>days</i> if expected duration is bigger than 24hours</li>
                                <!-- 2.9.2.5, 5.1.2020 -->
                                <li>The <a href="#progress">--progress</a> calculation ran into overshoots, showing e.g. 177%.</li>
                                <li>ln.exe now maintains its <a href="#choco">chocolatey package</a>.</li>
                                <li>ln.exe is public on <a href="https://gitlab.com/schinagl/link-shell-extension">gitlab</a>.</li>
                                <!-- 2.9.2.4, 28.10.2019 -->
                                <li>ln.exe is signed with a code signing certificate.</li>
                                <!-- 2.9.2.3, 26.4.2019 -->
                                <!-- 2.9.2.0, 4.4.2019 -->
                                <li>ln.exe is on gitlab.com. For now only private, but hope to change this soon.</li>
                                <!-- 2.9.1.x, xx.02.2019-->
                                <li>--delete now also deletes the starting directory.</li>
                                <!-- 2.9.1.3, 15.02.2019-->
                                <li>Division by zero with --progress in some situations.</li>
                                <li>The <a href="#deloreandelete">--delete option</a> has been modified to stop on outer reparse <a href="#innerjunction">boundaries</a>.</li>
                                <li>The <a href="#follow">--follow option</a> has been introduced to follow accross outer <a href="#innerjunction">reparse boundaries</a> during --delete.</li>
                                <!-- 2.9.1.1, 25.01.2019-->
                                <li>The 32bit version uses Wow64DisableWow64FsRedirection to access System32/ with x64 systems properly</li>
                                <li>Matching the first character of an wildcard expression with <a href="#excludewildcardsfiles">--exclude --include</a> was not correct</li>
                                <li>Empty lines on the filter file for wildcard expression caused an selection of *</li>
                                <li>The <a href="#progress">--progress option</a> should be more accurate and shows the remaining files</li>
                                <!-- 2.9.0.3, 25.12.2018-->
                                <li>[Internal] but important change from VS2005 (sic) to VS2017. Basically everything compiled smoothly except for the heap, thus...</li>
                                <li>
                                    [Internal] Removed the Rockall fast heap. This was neccessary, but also a big performance gain. Memory allocation is 2 times faster,
                                    and memory deletion is 10 times faster. Memory allocation is crucial for the core of ln.exe and LSE.
                                </li>
                                <li>[Internal] Dropped Itanium configuration, since VS2017 does not support it anymore, and I am sure there is no Itanium hardware out in the wild anymore.</li>
                                <!-- 2.8.7.302, 07.08.2018 -->
                                <li>Added the <a href="#supportfs">--supportfs</a> option.</li>
                                <li>DeloreanHanoi/Deloreancopy now use ln --delete instead of rd. Thx to Dietmar Kleiner</li>
                                <!-- 2.8.7.301, 31.05.2018 -->
                                <li>Wildcard expression didn't work correctly when using ~</li>
                                <!-- 2.8.7.3, 31.03.2018 -->
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            March 12, 2019
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2874">Version 2.8.7.4</a>
                            <ul>
                                <!-- 2.8.7.4, 12.03.2019 -->
                                <li>One last WindowsXP version</li>
                                <li>The <a href="#follow">--follow option</a> has been introduced to follow accross outer <a href="#innerjunction">reparse boundaries</a> during --delete.</li>
                                <li>Matching the first character of an wildcard expression with <a href="#excludewildcardsfiles">--exclude --include</a> was not correct</li>
                                <li>Empty lines on the filter file for wildcard expression caused an selection of *</li>
                                <!-- 2.8.7.302, 07.08.2018 -->
                                <li>DeloreanHanoi/Deloreancopy now use ln --delete instead of rd. Thx to Dietmar Kleiner</li>
                                <!-- 2.8.7.301, 31.05.2018 -->
                                <li>Wildcard expression didn't work correctly when using ~</li>
                                <!-- 2.8.7.3, 31.03.2018 -->
                                <li>DeloreanHanoi.bat can now also copy save whole drives, e.g. DeloreanHanoi.bat g:\ z:\save 5</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            May 21, 2018
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2873">Version 2.8.7.3</a>
                            <ul>
                                <li>DeloreanHanoi.bat can now also copy save whole drives, e.g. DeloreanHanoi.bat g:\ z:\save 5</li>
                                <!-- 2.8.7.3, 10.01.2017 -->
                                <li>Fixed too many links error handling during --mirror.</li>
                                <li><a href="#deloreandelete">Deletion of delorean</a> sets properly implemented.</li>
                                <li>Added the <a href="#deloreandelete">--delete</a> option.</li>
                                <li>--deeppathdelete can also delete single files.</li>
                                <li>Improved error reporting during <a href="#merge">--merge</a>, when files could not be merged.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            May 15, 2016
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2870">Version 2.8.7.2</a>
                            <ul>
                                <!-- 2.8.7.0, 14.03.2016 -->
                                <li>Avoids fragmentation during copy operations.</li>
                                <!-- 2.8.7.1, 15.04.2016 -->
                                <li>With --progress ln.exe could crash due to bogus progress calculation.</li>
                                <!-- 2.8.7.2, 15.05.2016 -->
                                <li>The <a href="#merge">--merge option</a> can now merge <a href="#deloreancopy">delorean backup </a> sets.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            March 14, 2016
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2869">Version 2.8.6.9</a>
                            <ul>
                                <!-- 2.8.6.502, 25.04.2015 -->
                                <li>Take 2: Files with different compression state between source and target were flagged as erroneous during --mirror.</li>
                                <!-- 2.8.6.504, 30.12.2015 -->
                                <li>Hardlinks were broken on copy when the source path was given via either <a href="#volumeguidsupport">VolumeGUID</a> or Windows Namespace</li>
                                <!-- 2.8.6.506, 1.01.2016 -->
                                <li>In --backup mode, when used with <a href="#anchormirror">--anchor</a>, <a href="#danglingjunction">dangling junctions</a> were not copied properly.</li>
                                <li>Wrong drive letter shown with <a href="#listsiblings">--list</a> on <a href="#substhandling">subst'd</a> drives.</li>
                                <li>Minor updates to <a href="#batfiles">deloreancopy.bat and DeloreanHanoi.bat</a> regarding script error handling.</li>
                                <li>Realtive symbolic links on absolute symbolic links to a different drive, were not created properly.</li>
                                <!-- 2.8.6.7, 1.02.2016 -->
                                <li>Relative symbolic links on UNC path were recreated with wrong target during SmartCopy.</li>
                                <!-- 2.8.6.8, 20.02.2016 -->
                                <li>The <a href="#progress">--progress</a> option shows the progress on the console.</li>
                                <!-- 2.8.6.9, 14.03.2016 -->
                                <li>With --progress the remaining time during --delorean was calculated wrong.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            May 17, 2015
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2865">Version 2.8.6.5</a>
                            <ul>
                                <!-- 2.8.6.1 -->
                                <li>The regular expression parser didn't use the extended regular expressions mode, but only the (obsolete) basic regular expression mode.</li>
                                <li>Accessing drives via <a href="#volumeguidsupport">Windows Namespace</a> in \\?\GLOBALROOT\Device is also possible.</li>
                                <!-- 2.8.6.3 -->
                                <li>Wait time needed during Delorean Copy due to <a href="#smb2redirectorcache">SMB2 Cache issues</a>.</li>
                                <li>Reading arguments from file for <a href="#excludewildcardsfiles">--ex/include</a> didn't work.</li>
                                <li><a href="#excludewildcardsfiles">--ex/include</a> failed with files containing ()[]{}-+$.</li>
                                <li>The combination of <a href="#anchormirror">--anchor and --mirror</a> was broken. The result was as if it was --copy.</li>
                                <li>The <a href="#smartmirror">--mirror</a> option didn't copy <a href="#backup">ACLs</a>.</li>
                                <!-- 2.8.6.4 -->
                                <li>Added handling for <a href="#invalidreparse">unsupported reparse points</a>.</li>
                                <!-- 2.8.6.5 -->
                                <li>Added the <a href="#1023safe">--1023safe option</a>.</li>
                                <li>The <a href="#smartmirror">--mirror</a> option didn't show the number of removed items in the summary.</li>
                                <li>The output can be in Json now by issuing the <a href="#json">--json</a> option.</li>
                                <li>Files with different compression state between source and target were flagged as erroneous during --mirror.</li>

                                <!-- 2.8.6.502, 25.04.2015 -->
                                <li>Take 2: Files with different compression state between source and target were flagged as erroneous during --mirror.</li>
                                <!-- 2.8.6.504, 30.12.2015 -->
                                <li>Hardlinks were broken on copy when the source path was given via either <a href="#volumeguidsupport">VolumeGUID</a> or Windows Namespace</li>
                                <!-- 2.8.6.506, 1.01.2016 -->
                                <li>In --backup mode, when used with <a href="#anchormirror">--anchor</a>, <a href="#danglingjunction">dangling junctions</a> were not copied properly.</li>
                                <li>Wrong drive letter shown with <a href="#listsiblings">--list</a> on <a href="#substhandling">subst'd</a> drives.</li>
                                <li>Minor updates to <a href="#batfiles">deloreancopy.bat and DeloreanHanoi.bat</a> regarding script error handling.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            November 10, 2014
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2860">Version 2.8.6.0</a>
                            <ul>
                                <!-- 2.8.6.0 -->
                                <li>DeloreanCopy with network drives as destination crashed in certain situations.</li>
                                <li>SmartClone on an empty folder created empty file for destination folder.</li>
                                <li>UNC path in some situations were chopped at the begining in the log-ouput.</li>
                                <li>Certain Unicode command line arguments could drive the command line parser crazy.</li>
                                <li><a href="#hardlinkclonemirror">Hardlink Clone Mirror</a> failed if files were already existing.</li>
                                <li>Several options support taking its content from a <a href="#excludewildcardsfiles">referenced file</a>.</li>
                                <li>Added the <a href="#anchor">--anchor</a>.</li>
                                <li><a href="#clonemirror">SymbolicLink Clone Mirror</a> sometimes removed and created symlinks unneccessarily.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            June 28, 2014
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2830">Version 2.8.5.3</a>
                            <ul>
                                <!-- 2.8.3.0 -->
                                <li>With --backup <a href="#filetypescopied">Encrypted Files</a> are copied too.</li>
                                <li>Junctions on <a href="#mappednetworkdrive">mapped network drives</a> are handled properly during all operations.</li>

                                <!-- 2.8.3.1 -->
                                <li>Added the <a href="#noads">--noads</a> option.</li>
                                <li>Added the <a href="#noea">--noea</a> option.</li>
                                <li>Errors during <a href="#adsfailed">copying ADS</a> are marked with the t charachter.</li>
                                <li>Errors during <a href="#eafailed">copying EA Records</a> are marked with the e character.</li>

                                <!-- 2.8.3.4 -->
                                <li>Fixed various issues under XP when symlinks were used.</li>
                                <li>Resource and speed improvments in --backup mode.</li>
                                <li>Listing of hardlink siblings with --traditional didn't show all siblings, when symbolic links were involved.</li>
                                <li>The .html docu has no .html format errors.</li>
                                <li>Added the <a href="bat/QueryPath.cmd">QueryPath</a> .bat file to determine the type of an file-object.</li>

                                <!-- 2.8.5.0 -->
                                <li>Tackled with the some more symlink and Windows XP issues.</li>
                                <li>ln.exe now can handle <a href="#mountpointcopy">mountpoints</a> during SmartXXX operations.</li>
                                <li>Documented the <a href="#destination">--destination</a> option.</li>
                                <li>WindowsXP: Symbolic links across drives didn't work.</li>
                                <li>WindowsXP: Symbolic links to <a href="#symbolicvolumeguid">Volume GUIDs</a> didn't work.</li>
                                <li>WindowsXP: Symbolic links between <a href="#deeppathsupport">very long path</a> didn't work.</li>
                                <li>WindowsXP: Lots of tweaks here and there.</li>

                                <!-- 2.8.5.1 -->
                                <li>Tweaked <a href="bat/DeLoreanHanoi.bat">DeloreanHanoi.bat</a>, a way to use ln.exe for the <a href="https://en.wikipedia.org/wiki/Backup_rotation_scheme#Tower_of_Hanoi">Tower of Hanoi backup rotation scheme</a>.</li>
                                <li>Files with a size beeing a multiple of 16777216 were copied properly, but generated an error message even if there was none.</li>

                                <!-- 2.8.5.2 -->
                                <li>Added <a href="#hardlinkclonemirror">Hardlink Clone Mirror</a> option: --recursive combined with --mirror now mirrors hardlink link clones.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            February 11, 2014
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2800">Version 2.8.1.0</a>
                            <ul>
                                <li>Introduced the <a href="#backup">--backup</a> switch which also copies ACLs.</li>
                                <li>Introduced the <a href="#keepsymlinkrelation">--keepsymlinkrelation</a> switch.</li>
                                <li>The --output option produced logfiles with LF but not CR/LF.</li>

                                <li>The --copy, --mirror and --delorean also copies <a href="#filetypescopied">sparse files</a> and alternative sparse streams.</li>
                                <li>Fixed a bug during copy, when a file was already there and the new file was smaller, it didn't copy over completely.  </li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            December 29, 2013
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2754">Version 2.7.5.9</a>
                            <ul>
                                <li>The --list function didn't return error messages when used on UNC paths.</li>
                                <li>Just --symbolic without argument caused a crash.</li>
                                <li>ln --copy x:\ x caused the folder x to be completely invisible, because GetFileAttributes() runs havoc on root dirs, e.g h:\.</li>
                                <li>The <a href="#uncnamesupport">UNC Support</a> has been improved and supports hardlink preservation for --copy, --delorean, --mirror.</li>
                                <li>Introduced the <a href="#probefs">--probefs</a> option.</li>
                                <li>The shadow copy .cmd file for <a href="#vss_unc.cmd">vss shares</a> via UNC name has been adapted.</li>
                                <li>Junctions can have now volume names like <a href="#junctionvolumeguid">\\?\Volume{GUID}\tmp</a> as target.</li>
                                <li>Symbolic Links can have now volume names like <a href="#symbolicvolumeguid">\\?\Volume{GUID}\tmp</a> as target.</li>
                                <li>Updated the documentation, and structured it based on alphabetical order of command line switches.</li>

                                <li>Fixed a bug in <a href="#excludewildcardsfiles">--exclude</a>, which prevented excluding files along a path.</li>
                                <li>Fixed a bug in <a href="#includewildcardsfiles">--include</a>, which prevented including files along a path.</li>

                                <li>A changed <a href="#faq02">file attribute</a> didn't cause the file to be treated as changed during all SmartXXX/Delorean functions.</li>

                                <li>Arguments to common operations support <a href="#volumeguidsupport">\\?\Volume{GUID}</a> as arguments.</li>
                                <li>The LastWriteTime, CreationTime and LastAccessTime for files/folders/junctions/symlinks is restored during <a href="#smartmirror">--mirror</a> or <a href="#deloreancopy">--delorean</a>.</li>
                                <li><s>Is able to delete very long path with the --deeppathdelete option.</s></li>

                                <li>Symbolic Link Clones always created absolute symlinks regardless of the command line args.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            August 30, 2013
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2751">Version 2.7.5.3</a>
                            <ul>
                                <li>Dead Junctions to a different drive could lead to not detecting hardlinks during all operations. Very Nasty, but no dataloss caused.</li>
                                <li>Introduced a <a href="#error0585">sanity check</a> for broken NTFS implementations.</li>
                                <li>Introduced On the Fly <a href="#dupemerge">DupeMerge</a>.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            May 9th, 2013
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2740">Version 2.7.4.9</a>
                            <ul>
                                <li>Memory Deallocation at the very end of ln.exe took ages when operating on millions of items.</li>
                                <li>During --mirror files in the destination with ReadOnly Attribute on were not mirrored.</li>
                                <li>--mirror didn't report errors at the end.</li>

                                <li>
                                    <a href="#timetolerance">--timetolerance</a> was introduced so that during --mirror and --delorean
                                    timestamp comparison is kind of fuzzy.
                                </li>
                                <li>
                                    Fixed a problem with --mirror when a directory changed into a file or vice versa
                                    from one mirror to the next and had exactly the same name.
                                </li>
                                <li>Compressed files are handled during SmartCopy/SmartMirror and DeloreanCopy.</li>

                                <li>Directory matches with --excludedir did not work properly with every expression.</li>
                                <li>Introduced the <a href="#includewildcardsfiles">--include*</a> options.</li>
                                <li>Added the <a href="#skipfiles">--skipfiles</a> option.</li>
                                <li>Sorted the options in the doku alphabetically.</li>

                                <li>Added kind of <a href="#clonemirror">'clonemirror'</a> option: --symbolic combined with --mirror now mirrors symbolic link clones.</li>
                                <li>Extended the <a href="bat/DeLoreanCopy.bat">DeloreanCopy.bat</a> with a 'number of keep-entry' argument. Thx to MathiasB for providing it.</li>

                                <li>The filters for --includeXXX or --excludeXXX are applied on source and destination during <a href="#smartmirror">--mirror</a> and <a href="#deloreancopy">--delorean</a>.</li>
                                <li>Added the <a href="bat/DeLoreanHanoi.bat">DeloreanHanoi.bat</a> to create backup sets using the <a href="https://en.wikipedia.org/wiki/Backup_rotation_scheme#Tower_of_Hanoi">Tower of Hanoi backup rotation scheme</a>.</li>

                                <li>Fixed a problem in UNC name resolution, when the UNC share was created by the Volume Shadow Service.</li>
                                <li>Added the <a href="bat/vss_unc.cmd">vss_unc.cmd</a> to create Volume Shadow Service backups via a UNC share.</li>

                                <li>The handling of the compression bit during copying/mirroring/deloreaning for files and directories was broken.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            June 24th, 2012
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2720">Version 2.7.2.0</a>
                            <ul>
                                <li>Fixed a problem with --truesize when used under Windows XP.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            April 11th, 2012
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2700">Version 2.7.1.6</a>
                            <ul>
                                <li>Introduced a <a href="#traditional">traditional mode</a> for SmartCopy, DeloreanCopy and SmartClone when used on network shared implementing SMBV10 (NAS boxes).</li>
                                <li>During SmartCopy, DeloreanCopy and SmartClone nested junctions/symbolic link directories were not processed correctly if alphabetical order was bad.</li>
                                <li>During SmartCopy, DeloreanCopy and SmartClone dangling junctions or symlinks will be at least in the same way dangling restored.</li>
                                <li><a href="#multiplesource">Multiple source locations </a> can be specified with SmartCopy, DeloreanCopy and SmartClone.</li>
                                <li><a href="#smartrename">SmartRename</a> was introduced.</li>
                                <li>SmartCopy, SmartMirror and DeloreanCopy accept FAT drives as source directory.</li>
                                <li>Support for <a href="#deeppathsupport">DeepPath operations</a> in SmartCopy, DeloreanCopy and SmartClone, SmartMove.</li>
                                <li>Fixed a problem in  <a href="#smartmove">SmartMove</a> which created dangling symbolic links, when using relative symbolic links in certain situations.</li>
                                <li>Fixed the problem of dangling junctions/symbolic links caused in certain situations with the multiple source option.</li>
                                <li>Create <a href="bat/DeLoreanCopy.bat">DeloreanCopy.bat</a> is now independent of region specific date time settings.</li>

                                <li>Support for <a href="#symboliclinksforwindowsxp">symbolic links under WXP</a>.</li>
                                <li>Can handle <a href="#substhandling">subst.exe created</a> driveletters.</li>
                                <li>Added a <a href="#truesize">--truesize</a> option.</li>
                                <li>More detailed <a href="#danglingjunction">reporting</a> when the restore of a dangling junction under windows XP fails.</li>

                                <li>Create Symbolic Link sometimes did not create absolute links when needed in certain situations.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            May 15th 2011
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2650">Version 2.6.5.0</a>
                            <ul>
                                <li>Speed improvements during SmartCopy/SmartMirror/HardlinkClone and Delorean Copy.</li>
                                <li>The <a href="#loglevel">log level</a> can be specified more granularly.</li>
                                <li>Introduced new Heap Manager Rockall for x64 and x86 builds to gain performance.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            April 17th 2011
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2600">Version 2.6.0.4</a>
                            <ul>
                                <li>Added options to <a href="#outerjunctionhandling">unroll and and splice Outer Junctions/Symbolic Links</a>.</li>
                                <li>Added options for <a href="#smartmirror">Smart Mirror</a>.</li>
                                <li>Smart Moves restores timestamps.</li>
                                <li>The log output of Smart Copy and Delorean Copy has been improved.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            December 20th 2010
                        </td>
                        <td align="left" class="bodytext">
                            <a name="2550">Version 2.5.5.5</a>
                            <ul>
                                <li>Added more powerful options to exclude files/directories via <a href="#excludewildcardsfiles">wildcards/regular expressions</a>.</li>
                                <li>Changed the regular expression machine to <a href="https://laurikari.net/tre">tre-0.8.0</a>.</li>
                                <li>Delorean Copy speed improvements by about 35% since 2.500 (without virus scanner).</li>
                                <li>Introduced <a href="#deloreancopy">DeLorean Copy</a>, which is a way of creating incremental copies using hardlinks.</li>
                                <li>Added a <a href="#batfiles">.bat file </a>section, which contains useful .bat wrappers around ln.exe</li>
                                <li>Fixed a minor memory leak/crash.</li>
                                <li>When specifying a rootpath e.g.: x:\ as source with --copy and --delorean, junctions were to rebuild properly in the destination.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            October 3rd 2010
                        </td>
                        <td align="left" class="bodytext">
                            Version 2.4.0.0
                            <ul>
                                <li>
                                    Hardlink Clone and Symboliclink Clone have been extended so that <a href="#recursivesupport">
                                        Inner Junctions and inner Symbolic Links
                                    </a> are properly handled.
                                </li>
                                <li>
                                    ln.exe by default creates <a href="#absolutesymboliclinks">relative</a> target
                                    path names when creating symbolic links.
                                </li>
                            </ul>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            May 22nd 2010
                        </td>
                        <td align="left" class="bodytext">
                            Version 2.3.5.4
                            <ul>
                                <li>Introduced the <a href="#smartmove">--move</a> option for Smart Move</li>
                                <li>The --copy option now also supports copying Symbolic Links under Vista and Windows7/8</li>
                                <li>Directories can now be symbolically linked</li>
                                <li>With W2K & NT4 readonly/hidden/system files could not be hardlinked</li>
                                <li>Hardlink Clone now restores the attributes of cloned folders.</li>
                            </ul>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            March 9th 2009
                        </td>
                        <td align="left" class="bodytext">
                            Version 2.2.0.6 Enumerate hardlink siblings for Vista
                            & Wxp, Symbolic link support vista<br />
                            Under W2K it turned out, that CreateHardlink() from kernel32.dll with long pathnames
                            (e.g. \\?\) was broken.
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            September 12th 2008
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.997 Introduced the <a href="#smartcopy">--copy</a>
                            option<br />
                            Enabled the <a href="#symboliclinks">--symbolic</a> option for Vista<br />
                            Introduced the <a href="#listsiblings">--list</a> option under Vista<br />
                            Added long (32k) path support<br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            February 17th 2006
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.810 Various small fixes related to commandline
                            parsing.
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            February 18th 2005
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.803 Fixed NT4 compatibility issues.
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            February 7th 2005
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.800 Fixed a few minor internal flaw related
                            to hardlink enumeration. Improved html documentation and added description for return
                            values.
                            <br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            November 26th 2004
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.711 decides between saturated and unsaturated
                            hardlinks when used with the --enum option.<br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            November 18th 2004
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.600 supports the enumerate functionality
                            via --enum switch<br />
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td class="hanger2">
                            June 24th 2004
                        </td>
                        <td align="left" class="bodytext">
                            Version 1.502 released<br />
                            <br />
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- Status -->
        <tr>
            <td class="hanger">
                Status
            </td>
            <td class="bodytext">
                <p>
                    The 2.9.3.x version is a stable version.
                </p>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>

        <!-- Acknowledgements -->
        <tr>
            <td class="hanger">
                <a name="acknowledgements">Acknowledgements</a>
            </td>

            <td class="bodytext">
                I wish to thank those who have contributed significantly to the development of ln.exe. Those include:
                <p>
                    Endre Both for being a great tester with endless patience and for excellent constructive feedback on features during development.
                </p>
                <br />
            </td>
        </tr>


        <!-- Open Issues -->
        <tr>
            <td class="hanger">
                Open Issues
            </td>
            <td class="bodytext">
                <p>
                    <br />
                </p>
                <br />
            </td>
        </tr>

        <!-- Links -->
        <tr>
            <td class="hanger">
                Links
            </td>
            <td class="bodytext">
                <ul>
                    <li>
                        Ville Laurikari developed an exceptional free <a href="https://laurikari.net/tre">regular expression parser</a>.<br />
                    </li>
                    <li>
                        Kevin Locke developed a great <a href="https://kevinlocke.name/programs/ultragetopt.php">command line parser</a>,
                        called ultragetopt.<br />
                    </li>
                </ul>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>

        <!-- License -->
        <tr>
            <td class="hanger">
                License
            </td>
            <td class="bodytext">
                <ul>
                    <li>This program is provided as is. See <a href="license.txt"> license.txt</a> from this distribution for legal issues.<br /></li>
                    <li>ln.exe uses <a href="https://laurikari.net/tre">tre</a> as the regular expression machine. See the <a href="license_tre.txt">tre license</a>.</li>
                    <li>ln.exe uses <a href="https://kevinlocke.name/programs/ultragetopt.php">ultragetopt</a> for command line parsing. See the <a href="license_ultragetop.txt">ultragetopt license</a>.</li>
                    <li>ln.exe uses <a href="https://github.com/calccrypto/uint128_t">uint128</a> for large number calculations. See the <a href="license_uint128.txt">uint128 license</a>.</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <br />
            </td>
        </tr>

        <!-- Contact / Donations -->
        <tr>
            <td class="hanger">
                <a name="contact">Contact / Donations</a>
            </td>
            <td class="bodytext">
                <p>
                    Bug reports, or feature requests send to <a href="mailto:Hermann.Schinagl@gmx.net">
                        Hermann Schinagl.
                    </a>.
                </p>
                <p>
                    ln.exe is and will be freeware, but if ln.exe was really helpful for you and saved
                    lots of your time please think of donations either via PayPal
                </p>
                <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
                    <input type="hidden" name="cmd" value="_donations" />
                    <input type="hidden" name="business" value="hermann.schinagl@gmx.net" />
                    <input type="hidden" name="item_name" value="Ln.exe Donation" />
                    <input type="hidden" name="no_shipping" value="0" />
                    <input type="hidden" name="no_note" value="1" />
                    <input type="hidden" name="currency_code" value="EUR" />
                    <input type="hidden" name="tax" value="0" />
                    <input type="hidden" name="lc" value="US" />
                    <input type="hidden" name="bn" value="PP-DonationsBF" />
                    <input type="image" src="https://www.paypal.com/en_US/i/btn/btn_donate_LG.gif"
                           name="submit" alt="PayPal - The safer, easier way to pay online!" />
                    <img alt="" src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" />
                </form>
                <br />

                or by flattring me
                <br />
                <a class="FlattrButton" style="display:none;" href="https://schinagl.priv.at/nt/ln/ln.html"></a>
                <noscript>
                    <a href="https://flattr.com/thing/181792/ln-Command-line-Hardlinks" target="_blank">
                        <img src="https://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" />
                    </a>
                </noscript>

                <p>
                    <br />
                    or by sending me a gift certificate from<br /><br />
                    <a href="https://www.amazon.de/gp/gc/ref=sv_w_0/302-2139848-0001645">
                        <img src="amazon.de.png" width="174" height="44" alt="amazon.de" />
                    </a>.
                </p>
                <br />

                <p>
                    <br /><br />
                    or by donating bitcoins:<br /><br />
                    <img src="bitcoinlogo.png" alt="bitcoinlogo" /><br />
                    <b>bc1q4hvevwrmnwt7jg8vws0v8xajywhffl4gwca5av</b>
                    <img alt="bitcoinlseqr" src="bitcoinlseqr.png" />
                </p>
                <br />
            </td>
        </tr>

        <!-- Download -->
        <tr>
            <td class="hanger">
                <a name="download">Download</a>
            </td>
            <td align="center" class="bodytext">
                <table cellspacing="0" cellpadding="0" border="0">
                    <tr>
                    <tr>
                        <td class="hanger2">
                            <b>Win64<br /></b>
                        </td>
                        <td align="left" class="bodytext">
                            Simply download and extract
                            <a href="https://schinagl.priv.at/nt/ln/ln64.zip">ln64.zip (2.30Mb)</a>
                            to your favourite tools directory. All neccesary runtime dlls are already installed on your system, but if not grab it from
                            <a href="https://aka.ms/vs/15/release/vc_redist.x64.exe">here.</a>
                            <br />
                            <br />
                            <br />
                        </td>
                    </tr>

                    <td class="hanger2">
                        <b>Win32<br /></b>
                    </td>
                    <td align="left" class="bodytext">
                        Simply download and extract
                        <a href="https://schinagl.priv.at/nt/ln/ln.zip">ln.zip (2.29Mb)</a>

                        to your favourite tools directory. All neccesary runtime dlls are already installed on your system, but if not grab it from
                        <a href="https://aka.ms/vs/15/release/vc_redist.x86.exe">here.</a>
                        <br />
                        <br />
                        <br />
                    </td>
        </tr>

        <tr>
            <td class="hanger2">
                <b>Chocolatey<br />Installation</b>
            </td>

            <td class="bodytext">
                ln.exe can also be installed via <a href="https://chocolatey.org">chocolatey</a> by issuing
                <br /><br />
                <span class="ascode">
                    choco install ln
                </span>
                <br />
                <br />
                from a command prompt. Make sure you have <a href="https://chocolatey.org/install">chocolatey installed</a>.
                <br />
                <br />
            </td>
        </tr>

        <tr>
            <td class="hanger2">
                <b>Winget<br />Installation</b>
            </td>

            <td class="bodytext">
                The 64bit version of ln.exe can also be installed via <a href="https://winget.run/">winget</a> by issuing
                <br /><br />
                <span class="ascode">
                    winget install HermannSchinagl.ln
                </span>
                <br />
                <br />
                from a command prompt. Make sure you have <a href="https://winget.run/">winget installed</a>.
                <br />
                <br />
            </td>
        </tr>

        <tr>
            <td class="hanger2">
                <b>Static<br />Win64</b>
            </td>
            <td align="left" class="bodytext">
                Simply download and extract
                <a href="https://schinagl.priv.at/nt/ln/ln64static.zip">ln64static.zip (2.30Mb)</a>
                to your favourite tools directory. No need for runtime dlls, thus can run under WinPE
                <br />
                <br />
                <br />
            </td>
        </tr>

        <tr>
            <td class="hanger2">
                <b>Static<br />Win32</b>
            </td>
            <td align="left" class="bodytext">
                Simply download and extract
                <a href="https://schinagl.priv.at/nt/ln/lnstatic.zip">lnstatic.zip (2.30Mb)</a>
                to your favourite tools directory. No need for runtime dlls, thus can run under WinPE
                <br />
                <br />
                <br />
            </td>
        </tr>

        <tr>
            <td colspan="2">
                &nbsp
            </td>
        </tr>
        <tr>
            <td colspan="2">
                &nbsp
                <br />
                <br />
                <br />
                <br />
                <br />
            </td>
        </tr>

    </table>


        <tr>
            <td align="right" valign="top">
                <b>
                    <a name="legacy">Legacy<br />Download</a>
                </b>
            </td>
            <td align="center">
                <table cellspacing="0" cellpadding="0" border="0">

                    <tr>
                        <td align="left" width="150" valign="top">
                            <b>
                                All Windows 2000/XP 32bit<br />
                            </b>
                        </td>
                        <td align="left" class="bodytext">
                            <p>
                                Please make sure that the necessary runtime .dlls
                                <a href="https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x86.EXE">
                                    vcredist_x86.exe for VS2005 SP1, version 6195/June 2011 (2.6 Mb)
                                </a>
                                are installed on your system.
                                Afterwards install the
                                <a href="https://www.schinagl.priv.at/nt/ln/save/2874/ln.zip">ln.zip (2.08Mb)</a>
                            </p>
                        </td>
                    </tr>


                    <tr>
                        <td align="left" width="150" valign="top">
                            <b>
                                All Windows 2000/XP 64bit<br />
                            </b>
                        </td>
                        <td align="left" class="bodytext">
                            Please make sure that the necessary runtime .dlls are
                            <a href="https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x64.EXE">
                                vcredist_x64.exe for VS2005 SP1, version 6195/June 2011 (3.0 Mb)
                            </a>
                            installed on your system. Afterwards install the
                            <a href="https://schinagl.priv.at/nt/ln/save/2874/ln64.zip">ln64.zip (2.14Mb)</a>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &nbsp
                        </td>
                    </tr>

                    <tr>
                        <td class="hanger2">
                            <b>
                                All Windows Itanium<br />
                            </b>
                        </td>
                        <td align="left" class="bodytext">
                            The Itanium version is not supported anymore, but the last VS2005 based version 2.8.7.4 is kept for legacy.
                            Please make sure that the necessary runtime .dlls are
                            installed on your system.
                            <a href="https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_IA64.EXE">
                                vcredist_IA64.exe for VS2005 SP1, version 6195/June 2011 (6.3 Mb)
                            </a>
                            Afterwards install the
                            <a href="https://schinagl.priv.at/nt/ln/save/2874/lnItanium.zip">
                                lnItanium.zip (2.40Mb)
                            </a>
                            <br />
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &nbsp
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &nbsp
                        </td>
                    </tr>


                    <tr>
                        <td class="hanger2">
                            <b>Symbolic Link Driver<br /> for Windows XP</b>
                        </td>
                        <td align="left" class="bodytext">
                            The driver to enable even WindowsXP with <a href="#symboliclinksforwindowsxp">
                                symbolic link functionality
                            </a> is provided courtesy of Masatoshi Kimura. Yo ucan download the driver from his
                            homepage or from my site acting as a mirror.

                            <br />
                            <br />
                            <center>
                                <a href="https://emk.name/symlink-1.06-x64.zip">
                                    Symbolic Drivers for WindowsXP 64 (86kb) [Original Location]
                                </a>
                                <br />

                                <a href="https://schinagl.priv.at/nt/hardlinkshellext/driver/symlink-1.06-x64.zip">
                                    Symbolic Drivers for WindowsXP 64 (86kb) [Mirror schinagl.priv.at]
                                </a>
                                <br />
                                <br />

                                <a href="https://emk.name/symlink-1.06-x86.cab">
                                    Symbolic Drivers for WindowsXP (86kb) [Original Location]
                                </a>
                                <br />

                                <a href="https://schinagl.priv.at/nt/hardlinkshellext/driver/symlink-1.06-x86.cab">
                                    Symbolic Drivers for WindowsXP (86kb) [Mirror schinagl.priv.at]
                                </a>
                                <br />
                                <br />

                                <a href="https://emk.name/symlink-1.06-src.zip">
                                    Sources for Drivers (23kb) [Original Location]
                                </a>
                                <br />
                                <a href="https://schinagl.priv.at/nt/hardlinkshellext/driver/symlink-1.06-src.zip">
                                    Sources for Drivers (23) [Mirror schinagl.priv.at]
                                </a>
                                <br />
                                <br />
                            </center>

                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            &nbsp
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
